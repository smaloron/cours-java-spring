<!DOCTYPE html SYSTEM "about:legacy-compat">
<html lang="en-US" data-preset="contrast" data-primary-color="#307FFF" data-resizable-sidebar="true"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="UTF-8"><meta name="robots" content="noindex"><meta name="built-on" content="2025-05-14T08:21:35.186092"><title>Les fichier .env | Spring</title><script type="application/json" id="virtual-toc-data">[{"id":"pourquoi-utiliser-un-fichier-env-avec-spring-boot","level":0,"title":"Pourquoi utiliser un fichier .env avec Spring Boot ?","anchor":"#pourquoi-utiliser-un-fichier-env-avec-spring-boot"},{"id":"int-gration-de-java-dotenv-dans-un-projet-spring-boot","level":0,"title":"Intégration de java-dotenv dans un Projet Spring Boot","anchor":"#int-gration-de-java-dotenv-dans-un-projet-spring-boot"},{"id":"acc-der-aux-variables-d-environnement-dans-spring-boot","level":0,"title":"Accéder aux Variables d\u0027Environnement dans Spring Boot","anchor":"#acc-der-aux-variables-d-environnement-dans-spring-boot"},{"id":"exercices-pratiques","level":0,"title":"Exercices Pratiques","anchor":"#exercices-pratiques"}]</script><script type="application/json" id="topic-shortcuts"></script><link href="https://resources.jetbrains.com/writerside/apidoc/6.22.0-b725/app.css" rel="stylesheet"><meta name="msapplication-TileColor" content="#000000"><link rel="apple-touch-icon" sizes="180x180" href="https://jetbrains.com/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="https://jetbrains.com/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="https://jetbrains.com/favicon-16x16.png"><meta name="msapplication-TileImage" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-144x144.png"><meta name="msapplication-square70x70logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-70x70.png"><meta name="msapplication-square150x150logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-150x150.png"><meta name="msapplication-wide310x150logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-310x150.png"><meta name="msapplication-square310x310logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-310x310.png"><meta name="image" content=""><!-- Open Graph --><meta property="og:title" content="Les fichier .env | Spring"><meta property="og:description" content=""><meta property="og:image" content=""><meta property="og:site_name" content="Spring Help"><meta property="og:type" content="website"><meta property="og:locale" content="en_US"><meta property="og:url" content="writerside-documentation/005-01-les-fichier-env.html"><!-- End Open Graph --><!-- Twitter Card --><meta name="twitter:card" content="summary_large_image"><meta name="twitter:site" content=""><meta name="twitter:title" content="Les fichier .env | Spring"><meta name="twitter:description" content=""><meta name="twitter:creator" content=""><meta name="twitter:image:src" content=""><!-- End Twitter Card --><!-- Schema.org WebPage --><script type="application/ld+json">{
    "@context": "http://schema.org",
    "@type": "WebPage",
    "@id": "writerside-documentation/005-01-les-fichier-env.html#webpage",
    "url": "writerside-documentation/005-01-les-fichier-env.html",
    "name": "Les fichier .env | Spring",
    "description": "",
    "image": "",
    "inLanguage":"en-US"
}</script><!-- End Schema.org --><!-- Schema.org WebSite --><script type="application/ld+json">{
    "@type": "WebSite",
    "@id": "writerside-documentation/#website",
    "url": "writerside-documentation/",
    "name": "Spring Help"
}</script><!-- End Schema.org --></head><body data-id="005-01-Les-fichier-env" data-main-title="Les fichier .env" data-article-props="{&quot;seeAlsoStyle&quot;:&quot;links&quot;}" data-template="article" data-breadcrumbs="004-00-La-configuration.md|La configuration"><div class="wrapper"><main class="panel _main"><header class="panel__header"><div class="container"><h3>Spring  Help</h3><div class="panel-trigger"></div></div></header><section class="panel__content"><div class="container"><article class="article" data-shortcut-switcher="inactive"><h1 data-toc="005-01-Les-fichier-env" id="005-01-Les-fichier-env.md">Les fichier .env</h1><p id="f5ya97_3">Spring Boot ne supporte pas <span class="emphasis" id="f5ya97_8">nativement</span> la lecture directe des fichiers <code class="code" id="f5ya97_9">.env</code> de la m&ecirc;me mani&egrave;re qu'il lit <code class="code" id="f5ya97_10">application.properties</code>. Cependant, il est tout &agrave; fait possible d'int&eacute;grer cette approche en utilisant une biblioth&egrave;que tierce. La biblioth&egrave;que la plus couramment utilis&eacute;e pour cela en Java est <code class="code" id="f5ya97_11">java-dotenv</code>.</p><section class="chapter"><h2 id="pourquoi-utiliser-un-fichier-env-avec-spring-boot" data-toc="pourquoi-utiliser-un-fichier-env-avec-spring-boot">Pourquoi utiliser un fichier <code class="code" id="f5ya97_15">.env</code> avec Spring Boot ?</h2><p id="f5ya97_13">L'utilisation d'un fichier <code class="code" id="f5ya97_16">.env</code> pr&eacute;sente plusieurs avantages :</p><ol class="list _decimal" id="f5ya97_14" type="1"><li class="list__item" id="f5ya97_17"><p id="f5ya97_21"><span class="control" id="f5ya97_22">S&eacute;paration de la Configuration</span>: Il s&eacute;pare clairement la configuration sensible ou sp&eacute;cifique &agrave; l'environnement du code source.</p></li><li class="list__item" id="f5ya97_18"><p id="f5ya97_23"><span class="control" id="f5ya97_24">S&eacute;curit&eacute;</span>: En ajoutant <code class="code" id="f5ya97_25">.env</code> au fichier <code class="code" id="f5ya97_26">.gitignore</code>, on &eacute;vite de commiter des informations sensibles (cl&eacute;s d'API, mots de passe) dans le d&eacute;p&ocirc;t de code.</p></li><li class="list__item" id="f5ya97_19"><p id="f5ya97_27"><span class="control" id="f5ya97_28">Simplicit&eacute; pour le D&eacute;veloppement Local</span>: Chaque d&eacute;veloppeur peut avoir son propre fichier <code class="code" id="f5ya97_29">.env</code> avec ses configurations locales sans affecter les autres.</p></li><li class="list__item" id="f5ya97_20"><p id="f5ya97_30"><span class="control" id="f5ya97_31">Coh&eacute;rence entre Projets</span>: Si une &eacute;quipe travaille sur des projets utilisant diff&eacute;rentes technologies (Node.js, Python, Java), l'utilisation de <code class="code" id="f5ya97_32">.env</code> peut apporter une certaine coh&eacute;rence dans la gestion de la configuration d'environnement.</p></li></ol></section><section class="chapter"><h2 id="int-gration-de-java-dotenv-dans-un-projet-spring-boot" data-toc="int-gration-de-java-dotenv-dans-un-projet-spring-boot">Int&eacute;gration de <code class="code" id="f5ya97_49">java-dotenv</code> dans un Projet Spring Boot</h2><p id="f5ya97_34">Pour utiliser un fichier <code class="code" id="f5ya97_50">.env</code> dans Spring Boot, il faut ajouter la d&eacute;pendance <code class="code" id="f5ya97_51">java-dotenv</code> au projet.</p><p id="f5ya97_35"><span class="control" id="f5ya97_52">1. Ajouter la D&eacute;pendance</span></p><ul class="list _bullet" id="f5ya97_36"><li class="list__item" id="f5ya97_53"><p id="f5ya97_54"><span class="control" id="f5ya97_55">Avec Maven</span> (dans <code class="code" id="f5ya97_56">pom.xml</code>) :</p></li></ul><div class="code-block" data-lang="markup">

&lt;dependency&gt;
    &lt;groupId&gt;io.github.cdimascio&lt;/groupId&gt;
    &lt;artifactId&gt;java-dotenv&lt;/artifactId&gt;
    &lt;version&gt;5.2.2&lt;/version&gt; &lt;!-- Vérifiez la dernière version --&gt;
&lt;/dependency&gt;
</div><p id="f5ya97_38"><span class="control" id="f5ya97_57">2. Charger le Fichier <code class="code" id="f5ya97_58">.env</code> au D&eacute;marrage</span></p><p id="f5ya97_39">La biblioth&egrave;que <code class="code" id="f5ya97_59">java-dotenv</code> doit charger les variables du fichier <code class="code" id="f5ya97_60">.env</code> <span class="emphasis" id="f5ya97_61">avant</span> que Spring Boot ne commence &agrave; lire sa configuration. Le meilleur endroit pour faire cela est au tout d&eacute;but de la m&eacute;thode <code class="code" id="f5ya97_62">main</code>.</p><p id="f5ya97_40">La biblioth&egrave;que charge les variables du fichier <code class="code" id="f5ya97_63">.env</code> (qui doit se trouver &agrave; la racine du projet par d&eacute;faut) et les injecte dans les <span class="emphasis" id="f5ya97_64">propri&eacute;t&eacute;s syst&egrave;me</span> Java (<code class="code" id="f5ya97_65">System.getProperties()</code>) ou, selon la configuration, dans les <span class="emphasis" id="f5ya97_66">variables d'environnement</span> du processus. Spring Boot lit ensuite ces propri&eacute;t&eacute;s syst&egrave;me et variables d'environnement comme sources de configuration valides.</p><p id="f5ya97_41"><span class="control" id="f5ya97_67">Exemple de modification de la classe principale :</span></p><div class="code-block" data-lang="java">
package fr.formation.spring;

import io.github.cdimascio.dotenv.Dotenv; // Import nécessaire
import org.springframework.boot.SpringApplication;
import org.springframework.boot.autoconfigure.SpringBootApplication;

@SpringBootApplication
public class DemoApplication {

    public static void main(String[] args) {
        // Charger les variables du fichier .env
        // Il est crucial de le faire AVANT SpringApplication.run(...)
        // 'load()' les charge dans les propriétés système par défaut.
        Dotenv dotenv = Dotenv.configure()
                .ignoreIfMissing() // Ne pas échouer si .env manque
                .load();

        SpringApplication.run(DemoApplication.class, args);
    }
}
</div><p id="f5ya97_43"><span class="control" id="f5ya97_68">3. Cr&eacute;er le Fichier <code class="code" id="f5ya97_69">.env</code></span></p><p id="f5ya97_44">&Agrave; la racine du projet, cr&eacute;ez un fichier nomm&eacute; <code class="code" id="f5ya97_70">.env</code>.</p><p id="f5ya97_45"><span class="control" id="f5ya97_71">Exemple de fichier <code class="code" id="f5ya97_72">.env</code>:</span></p><div class="code-block" data-lang="none">
# Configuration de la base de données
DATABASE_URL=jdbc:postgresql://localhost:5432/mydatabase
DATABASE_USER=mon_utilisateur
DATABASE_PASSWORD=mon_mot_de_passe_secret

# Clé d'API pour un service externe
API_SERVICE_KEY=abcdef1234567890
API_SERVICE_URL=https://api.externalservice.com

# Configuration spécifique à l'application
APP_FEATURE_FLAG_ENABLED=true
APP_DEFAULT_PAGE_SIZE=20
</div><p id="f5ya97_47"><span class="control" id="f5ya97_73">Important :</span> Ajoutez <code class="code" id="f5ya97_74">.env</code> &agrave; votre fichier <code class="code" id="f5ya97_75">.gitignore</code> pour ne pas l'inclure dans les commits !</p><div class="code-block" data-lang="gitignore">
# Fichiers d'environnement locaux
.env
.env.*

# Fichiers générés par l'IDE
# ... autres exclusions ...
</div></section><section class="chapter"><h2 id="acc-der-aux-variables-d-environnement-dans-spring-boot" data-toc="acc-der-aux-variables-d-environnement-dans-spring-boot">Acc&eacute;der aux Variables d'Environnement dans Spring Boot</h2><p id="f5ya97_76">Une fois que <code class="code" id="f5ya97_81">java-dotenv</code> a charg&eacute; les variables dans les propri&eacute;t&eacute;s syst&egrave;me ou l'environnement, Spring Boot peut y acc&eacute;der de ses mani&egrave;res habituelles :</p><section class="chapter"><h3 id="1-via-value" data-toc="1-via-value"><span class="control" id="f5ya97_85">1. Via <code class="code" id="f5ya97_86">@Value</code></span></h3><p id="f5ya97_83">C'est la m&eacute;thode la plus simple pour injecter une seule propri&eacute;t&eacute;.</p><div class="code-block" data-lang="java">
package fr.formation.spring.service;

import org.springframework.beans.factory.annotation.Value;
import org.springframework.stereotype.Service;

@Service
public class ApiService {

    // Injection de la valeur depuis .env (via les propriétés système)
    // Le ':' permet de définir une valeur par défaut si la clé n'existe pas
    @Value(&quot;${API_SERVICE_KEY:defaultApiKey}&quot;)
    private String apiKey;

    @Value(&quot;${API_SERVICE_URL}&quot;)
    private String serviceUrl;

    public void useApiKey() {
        System.out.println(&quot;Utilisation de l'URL : &quot; + serviceUrl);
        System.out.println(&quot;Utilisation de la clé d'API : &quot; + apiKey);
        // Logique métier utilisant la clé d'API...
    }
}
</div></section><section class="chapter"><h3 id="2-via-configurationproperties" data-toc="2-via-configurationproperties"><span class="control" id="f5ya97_96">2. Via <code class="code" id="f5ya97_97">@ConfigurationProperties</code></span></h3><p id="f5ya97_88">Cette approche est recommand&eacute;e pour regrouper des propri&eacute;t&eacute;s li&eacute;es. Elle est plus type-safe et mieux organis&eacute;e.</p><ul class="list _bullet" id="f5ya97_89"><li class="list__item" id="f5ya97_98"><p id="f5ya97_99"><span class="control" id="f5ya97_100">Cr&eacute;er une classe de configuration :</span></p></li></ul><div class="code-block" data-lang="java">
package fr.formation.spring.config;

import org.springframework.boot.context.properties.ConfigurationProperties;
import org.springframework.context.annotation.Configuration;
// Optionnel: validation
// import javax.validation.constraints.NotEmpty; 
// import javax.validation.constraints.NotNull;

// Lie les propriétés préfixées par &quot;database&quot;
@Configuration
// Le préfixe doit correspondre aux clés dans .env (minuscules/kebab-case)
// MAIS java-dotenv charge souvent en majuscules/underscore.
// Spring Boot est flexible et tente de faire correspondre 
// DATABASE_URL ou database.url à database.url
@ConfigurationProperties(prefix = &quot;database&quot;)
public class DatabaseConfig {

    // @NotEmpty // Nécessite spring-boot-starter-validation
    private String url; // Correspond à DATABASE_URL

    // @NotEmpty
    private String user; // Correspond à DATABASE_USER

    // @NotEmpty
    private String password; // Correspond à DATABASE_PASSWORD

    // Getters et Setters nécessaires pour @ConfigurationProperties
    public String getUrl() {
        return url;
    }

    public void setUrl(String url) {
        this.url = url;
    }

    public String getUser() {
        return user;
    }

    public void setUser(String user) {
        this.user = user;
    }

    public String getPassword() {
        return password;
    }

    public void setPassword(String password) {
        this.password = password;
    }
}
</div><ul class="list _bullet" id="f5ya97_91"><li class="list__item" id="f5ya97_101"><p id="f5ya97_102"><span class="control" id="f5ya97_103">Activer <code class="code" id="f5ya97_104">@ConfigurationProperties</code></span></p></li></ul><p id="f5ya97_92">Il faut s'assurer que Spring Boot scanne et active ces classes. On peut le faire via <code class="code" id="f5ya97_105">@EnableConfigurationProperties</code> sur une classe de configuration principale ou sur la classe <code class="code" id="f5ya97_106">Application</code>.</p><div class="code-block" data-lang="java">
package fr.formation.spring;

import io.github.cdimascio.dotenv.Dotenv;
import org.springframework.boot.SpringApplication;
import org.springframework.boot.autoconfigure.SpringBootApplication;
import org.springframework.boot.context.properties.EnableConfigurationProperties;

// Import de la classe de configuration
import fr.formation.spring.config.DatabaseConfig;

@SpringBootApplication
@EnableConfigurationProperties(DatabaseConfig.class) // Activer la classe
public class DemoApplication {

    public static void main(String[] args) {
        Dotenv dotenv = Dotenv.configure().ignoreIfMissing().load();
        SpringApplication.run(DemoApplication.class, args);
    }
}
</div><ul class="list _bullet" id="f5ya97_94"><li class="list__item" id="f5ya97_107"><p id="f5ya97_108"><span class="control" id="f5ya97_109">Utiliser la configuration inject&eacute;e :</span></p></li></ul><div class="code-block" data-lang="java">
package fr.formation.spring.component;

import fr.formation.spring.config.DatabaseConfig;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Component;
import jakarta.annotation.PostConstruct; // Depuis Java 9+

@Component
public class DatabaseConnector {

    private final DatabaseConfig dbConfig;

    // Injection de la configuration via le constructeur (bonne pratique)
    @Autowired
    public DatabaseConnector(DatabaseConfig dbConfig) {
        this.dbConfig = dbConfig;
    }

    @PostConstruct // Méthode appelée après l'initialisation du bean
    public void connect() {
        System.out.println(&quot;Connexion à la base de données...&quot;);
        System.out.println(&quot;URL: &quot; + dbConfig.getUrl());
        System.out.println(&quot;Utilisateur: &quot; + dbConfig.getUser());
        // Ne jamais afficher le mot de passe en production !
        // System.out.println(&quot;Mot de passe: &quot; + dbConfig.getPassword());
        System.out.println(&quot;Connexion simulée établie.&quot;);
    }
}
</div></section><section class="chapter"><h3 id="bonnes-pratiques" data-toc="bonnes-pratiques">Bonnes Pratiques</h3><ol class="list _decimal" id="f5ya97_110" type="1"><li class="list__item" id="f5ya97_111"><p id="f5ya97_117"><span class="control" id="f5ya97_118">Ne Jamais Commiter <code class="code" id="f5ya97_120">.env</code></span>: C'est la r&egrave;gle d'or. Utilisez <code class="code" id="f5ya97_119">.gitignore</code>.</p></li><li class="list__item" id="f5ya97_112"><p id="f5ya97_121"><span class="control" id="f5ya97_122">Utiliser un Fichier <code class="code" id="f5ya97_126">.env.example</code></span>: Cr&eacute;ez un fichier <code class="code" id="f5ya97_123">.env.example</code> (ou <code class="code" id="f5ya97_124">.env.template</code>) qui liste toutes les variables n&eacute;cessaires mais avec des valeurs vides ou des exemples. Ce fichier <span class="emphasis" id="f5ya97_125">peut</span> &ecirc;tre commit&eacute; pour guider les autres d&eacute;veloppeurs.</p></li><li class="list__item" id="f5ya97_113"><p id="f5ya97_127"><span class="control" id="f5ya97_128">Convention de Nommage</span>: Utilisez des majuscules et des underscores (<code class="code" id="f5ya97_129">DATABASE_URL</code>) dans le fichier <code class="code" id="f5ya97_130">.env</code>, ce qui est une convention courante pour les variables d'environnement. Spring Boot est assez intelligent pour mapper <code class="code" id="f5ya97_131">DATABASE_URL</code> &agrave; <code class="code" id="f5ya97_132">database.url</code> dans <code class="code" id="f5ya97_133">@ConfigurationProperties</code> ou <code class="code" id="f5ya97_134">${database.url}</code> dans <code class="code" id="f5ya97_135">@Value</code>.</p></li><li class="list__item" id="f5ya97_114"><p id="f5ya97_136"><span class="control" id="f5ya97_137">Gestion des Environnements Multiples</span>: Pour diff&eacute;rents environnements (dev, staging, prod), n'utilisez pas plusieurs fichiers <code class="code" id="f5ya97_138">.env</code> (<code class="code" id="f5ya97_139">.env.dev</code>, <code class="code" id="f5ya97_140">.env.prod</code>) g&eacute;r&eacute;s par <code class="code" id="f5ya97_141">java-dotenv</code> car cela complique le d&eacute;ploiement. Pr&eacute;f&eacute;rez les m&eacute;canismes standards de Spring Boot (profils, variables d'environnement syst&egrave;me fournies par la plateforme de d&eacute;ploiement comme Docker, Kubernetes, Cloud Foundry, etc.). Le fichier <code class="code" id="f5ya97_142">.env</code> est surtout utile pour le d&eacute;veloppement local.</p></li><li class="list__item" id="f5ya97_115"><p id="f5ya97_143"><span class="control" id="f5ya97_144">Valeurs par D&eacute;faut</span>: Utilisez les valeurs par d&eacute;faut de Spring Boot (<code class="code" id="f5ya97_145">@Value(&quot;${PROPERTY_KEY:defaultValue}&quot;)</code>) ou dans la classe <code class="code" id="f5ya97_146">@ConfigurationProperties</code> pour rendre l'application plus r&eacute;siliente si une variable n'est pas d&eacute;finie.</p></li><li class="list__item" id="f5ya97_116"><p id="f5ya97_147"><span class="control" id="f5ya97_148">Chargement Pr&eacute;coce</span>: Assurez-vous que <code class="code" id="f5ya97_149">Dotenv.load()</code> est appel&eacute; tout au d&eacute;but de la m&eacute;thode <code class="code" id="f5ya97_150">main</code>.</p></li></ol></section><section class="chapter"><h3 id="cas-d-utilisation-typiques" data-toc="cas-d-utilisation-typiques">Cas d'Utilisation Typiques</h3><ul class="list _bullet" id="f5ya97_151"><li class="list__item" id="f5ya97_152"><p id="f5ya97_157"><span class="control" id="f5ya97_158">Identifiants de Base de Donn&eacute;es</span>: URL, utilisateur, mot de passe pour la base de donn&eacute;es locale.</p></li><li class="list__item" id="f5ya97_153"><p id="f5ya97_159"><span class="control" id="f5ya97_160">Cl&eacute;s d'API</span>: Cl&eacute;s pour des services tiers (Stripe, SendGrid, Google Maps, etc.).</p></li><li class="list__item" id="f5ya97_154"><p id="f5ya97_161"><span class="control" id="f5ya97_162">Secrets d'Application</span>: Cl&eacute;s secr&egrave;tes pour JWT, configurations de s&eacute;curit&eacute;.</p></li><li class="list__item" id="f5ya97_155"><p id="f5ya97_163"><span class="control" id="f5ya97_164">URLs de Services Externes</span>: Adresses de microservices ou d'API externes sp&eacute;cifiques &agrave; l'environnement de d&eacute;veloppement.</p></li><li class="list__item" id="f5ya97_156"><p id="f5ya97_165"><span class="control" id="f5ya97_166">Feature Flags Locaux</span>: Activer/d&eacute;sactiver des fonctionnalit&eacute;s pour le d&eacute;veloppement local.</p></li></ul></section></section><section class="chapter"><h2 id="exercices-pratiques" data-toc="exercices-pratiques">Exercices Pratiques</h2><section class="chapter"><h3 id="exercice-1-configuration-simple-d-un-service-email" data-toc="exercice-1-configuration-simple-d-un-service-email"><span class="control" id="f5ya97_175">Exercice 1 : Configuration Simple d'un Service Email</span></h3><p id="f5ya97_172"><span class="control" id="f5ya97_176">Objectif</span>: Configurer l'adresse d'un serveur SMTP et un port via un fichier <code class="code" id="f5ya97_177">.env</code> et l'afficher dans un service.</p><ol class="list _decimal" id="f5ya97_173" type="1"><li class="list__item" id="f5ya97_178"><p id="f5ya97_183"><span class="control" id="f5ya97_185">Cr&eacute;ez/Modifiez votre fichier <code class="code" id="f5ya97_186">.env</code></span> &agrave; la racine du projet avec le contenu suivant :</p><div class="code-block" data-lang="none">
SMTP_HOST=smtp.local.dev
SMTP_PORT=1025 
</div></li><li class="list__item" id="f5ya97_179"><p id="f5ya97_187"><span class="control" id="f5ya97_188">Assurez-vous que <code class="code" id="f5ya97_190">java-dotenv</code> est configur&eacute;</span> dans votre classe <code class="code" id="f5ya97_189">DemoApplication</code> (comme montr&eacute; pr&eacute;c&eacute;demment).</p></li><li class="list__item" id="f5ya97_180"><p id="f5ya97_191"><span class="control" id="f5ya97_192">Cr&eacute;ez un nouveau service</span> <code class="code" id="f5ya97_193">fr.formation.spring.service.NotificationService</code> qui utilise <code class="code" id="f5ya97_194">@Value</code> pour injecter <code class="code" id="f5ya97_195">SMTP_HOST</code> et <code class="code" id="f5ya97_196">SMTP_PORT</code>.</p></li><li class="list__item" id="f5ya97_181"><p id="f5ya97_197"><span class="control" id="f5ya97_198">Ajoutez une m&eacute;thode</span> dans ce service (par exemple, <code class="code" id="f5ya97_199">sendTestNotification</code>) qui affiche les valeurs inject&eacute;es dans la console.</p></li><li class="list__item" id="f5ya97_182"><p id="f5ya97_200"><span class="control" id="f5ya97_201">Injectez et appelez</span> ce service depuis un composant ou un <code class="code" id="f5ya97_202">CommandLineRunner</code> pour v&eacute;rifier le r&eacute;sultat au d&eacute;marrage.</p></li></ol><section class="chapter"><div class="collapse"><div class="collapse__title"><h4 id="correction-de-l-exercice-1" data-toc="correction-de-l-exercice-1"><span class="control" id="f5ya97_209">Correction de l'Exercice 1 :</span></h4></div><div class="collapse__content"><ul class="list _bullet" id="f5ya97_204"><li class="list__item" id="f5ya97_210"><p id="f5ya97_213"><span class="control" id="f5ya97_214">Fichier <code class="code" id="f5ya97_215">.env</code>:</span> (Comme ci-dessus)</p></li><li class="list__item" id="f5ya97_211"><p id="f5ya97_216"><span class="control" id="f5ya97_217"><code class="code" id="f5ya97_220">DemoApplication.java</code>:</span> (Doit inclure <code class="code" id="f5ya97_218">Dotenv.load()</code> au d&eacute;but de <code class="code" id="f5ya97_219">main</code>)</p></li><li class="list__item" id="f5ya97_212"><p id="f5ya97_221"><span class="control" id="f5ya97_222"><code class="code" id="f5ya97_223">NotificationService.java</code>:</span></p></li></ul><div class="code-block" data-lang="java">
package fr.formation.spring.service;

import org.springframework.beans.factory.annotation.Value;
import org.springframework.stereotype.Service;
import jakarta.annotation.PostConstruct;

@Service
public class NotificationService {

    // Injection depuis .env via les propriétés système
    @Value(&quot;${SMTP_HOST}&quot;)
    private String smtpHost;

    // Spring peut convertir en Integer si la valeur est un nombre valide
    @Value(&quot;${SMTP_PORT}&quot;)
    private int smtpPort;

    @PostConstruct // Appel après injection des dépendances
    public void sendTestNotification() {
        System.out.println(&quot;--- Configuration Notification ---&quot;);
        System.out.println(&quot;Serveur SMTP Host: &quot; + smtpHost);
        System.out.println(&quot;Serveur SMTP Port: &quot; + smtpPort);
        System.out.println(&quot;Prêt à envoyer des notifications (simulation).&quot;);
        System.out.println(&quot;---------------------------------&quot;);
    }
}
</div><ul class="list _bullet" id="f5ya97_206"><li class="list__item" id="f5ya97_224"><p id="f5ya97_225"><span class="control" id="f5ya97_226">(Optionnel) <code class="code" id="f5ya97_227">AppRunner.java</code> pour tester au d&eacute;marrage :</span></p></li></ul><div class="code-block" data-lang="java">
package fr.formation.spring.runner;

import fr.formation.spring.service.NotificationService;
import org.springframework.boot.CommandLineRunner;
import org.springframework.stereotype.Component;

@Component
public class AppRunner implements CommandLineRunner {

    private final NotificationService notificationService;

    // Injection du service
    public AppRunner(NotificationService notificationService) {
        this.notificationService = notificationService;
    }

    @Override
    public void run(String... args) throws Exception {
        // Le @PostConstruct de NotificationService s'exécute déjà,
        // mais on pourrait appeler d'autres méthodes ici si nécessaire.
        System.out.println(&quot;AppRunner: NotificationService initialisé.&quot;);
    }
}
</div></div></div></section></section><section class="chapter"><h3 id="exercice-2-configuration-group-e-avec-configurationproperties" data-toc="exercice-2-configuration-group-e-avec-configurationproperties"><span class="control" id="f5ya97_232">Exercice 2 : Configuration Group&eacute;e avec <code class="code" id="f5ya97_233">@ConfigurationProperties</code></span></h3><p id="f5ya97_229"><span class="control" id="f5ya97_234">Objectif</span>: Regrouper la configuration d'un service de cache (par exemple, Redis) en utilisant <code class="code" id="f5ya97_235">@ConfigurationProperties</code>.</p><ol class="list _decimal" id="f5ya97_230" type="1"><li class="list__item" id="f5ya97_236"><p id="f5ya97_241"><span class="control" id="f5ya97_243">Ajoutez les lignes suivantes</span> &agrave; votre fichier <code class="code" id="f5ya97_244">.env</code>:</p><div class="code-block" data-lang="none">
CACHE_HOST=localhost
CACHE_PORT=6379
CACHE_ENABLED=true
</div></li><li class="list__item" id="f5ya97_237"><p id="f5ya97_245"><span class="control" id="f5ya97_246">Cr&eacute;ez une classe de configuration</span> <code class="code" id="f5ya97_247">fr.formation.spring.config.CacheConfig</code> annot&eacute;e avec <code class="code" id="f5ya97_248">@ConfigurationProperties(prefix = &quot;cache&quot;)</code> pour mapper ces trois propri&eacute;t&eacute;s (<code class="code" id="f5ya97_249">host</code>, <code class="code" id="f5ya97_250">port</code>, <code class="code" id="f5ya97_251">enabled</code>). N'oubliez pas les getters et setters.</p></li><li class="list__item" id="f5ya97_238"><p id="f5ya97_252"><span class="control" id="f5ya97_253">Activez cette configuration</span> en ajoutant <code class="code" id="f5ya97_254">CacheConfig.class</code> &agrave; l'annotation <code class="code" id="f5ya97_255">@EnableConfigurationProperties</code> dans votre classe <code class="code" id="f5ya97_256">DemoApplication</code>.</p></li><li class="list__item" id="f5ya97_239"><p id="f5ya97_257"><span class="control" id="f5ya97_258">Cr&eacute;ez un composant</span> <code class="code" id="f5ya97_259">fr.formation.spring.component.CacheManager</code> qui injecte <code class="code" id="f5ya97_260">CacheConfig</code>.</p></li><li class="list__item" id="f5ya97_240"><p id="f5ya97_261"><span class="control" id="f5ya97_262">Dans une m&eacute;thode <code class="code" id="f5ya97_264">@PostConstruct</code></span> de <code class="code" id="f5ya97_263">CacheManager</code>, affichez les valeurs de configuration pour v&eacute;rifier qu'elles sont correctement charg&eacute;es.</p></li></ol><section class="chapter"><div class="collapse"><div class="collapse__title"><h4 id="correction-de-l-exercice-2" data-toc="correction-de-l-exercice-2"><span class="control" id="f5ya97_273">Correction de l'Exercice 2 :</span></h4></div><div class="collapse__content"><ul class="list _bullet" id="f5ya97_266"><li class="list__item" id="f5ya97_274"><p id="f5ya97_276"><span class="control" id="f5ya97_277">Fichier <code class="code" id="f5ya97_281">.env</code>:</span> (Contient les lignes <code class="code" id="f5ya97_278">CACHE_HOST</code>, <code class="code" id="f5ya97_279">CACHE_PORT</code>, <code class="code" id="f5ya97_280">CACHE_ENABLED</code>)</p></li><li class="list__item" id="f5ya97_275"><p id="f5ya97_282"><span class="control" id="f5ya97_283"><code class="code" id="f5ya97_284">CacheConfig.java</code>:</span></p></li></ul><div class="code-block" data-lang="java">
package fr.formation.spring.config;

import org.springframework.boot.context.properties.ConfigurationProperties;
import org.springframework.context.annotation.Configuration;

@Configuration // Rendre la classe découvrable comme bean de configuration
@ConfigurationProperties(prefix = &quot;cache&quot;) // Lie les propriétés cache.*
public class CacheConfig {

    private String host; // Correspond à CACHE_HOST
    private int port;    // Correspond à CACHE_PORT
    private boolean enabled; // Correspond à CACHE_ENABLED

    // Getters et Setters requis
    public String getHost() {
        return host;
    }

    public void setHost(String host) {
        this.host = host;
    }

    public int getPort() {
        return port;
    }

    public void setPort(int port) {
        this.port = port;
    }

    public boolean isEnabled() {
        return enabled;
    }

    public void setEnabled(boolean enabled) {
        this.enabled = enabled;
    }
}
</div><ul class="list _bullet" id="f5ya97_268"><li class="list__item" id="f5ya97_285"><p id="f5ya97_286"><span class="control" id="f5ya97_287"><code class="code" id="f5ya97_288">DemoApplication.java</code> (mise &agrave; jour) :</span></p></li></ul><div class="code-block" data-lang="java">
package fr.formation.spring;

import io.github.cdimascio.dotenv.Dotenv;
import org.springframework.boot.SpringApplication;
import org.springframework.boot.autoconfigure.SpringBootApplication;
import org.springframework.boot.context.properties.EnableConfigurationProperties;

// Importer les deux classes de configuration
import fr.formation.spring.config.DatabaseConfig;
import fr.formation.spring.config.CacheConfig;

@SpringBootApplication
// Activer les deux configurations
@EnableConfigurationProperties({DatabaseConfig.class, CacheConfig.class})
public class DemoApplication {

    public static void main(String[] args) {
        Dotenv dotenv = Dotenv.configure().ignoreIfMissing().load();
        SpringApplication.run(DemoApplication.class, args);
    }
}
</div><ul class="list _bullet" id="f5ya97_270"><li class="list__item" id="f5ya97_289"><p id="f5ya97_290"><span class="control" id="f5ya97_291"><code class="code" id="f5ya97_292">CacheManager.java</code>:</span></p></li></ul><div class="code-block" data-lang="java">
package fr.formation.spring.component;

import fr.formation.spring.config.CacheConfig;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Component;
import jakarta.annotation.PostConstruct;

@Component
public class CacheManager {

    private final CacheConfig cacheConfig;

    @Autowired // Injection via constructeur
    public CacheManager(CacheConfig cacheConfig) {
        this.cacheConfig = cacheConfig;
    }

    @PostConstruct
    public void displayCacheConfiguration() {
        System.out.println(&quot;--- Configuration Cache ---&quot;);
        System.out.println(&quot;Cache Hôte: &quot; + cacheConfig.getHost());
        System.out.println(&quot;Cache Port: &quot; + cacheConfig.getPort());
        System.out.println(&quot;Cache Activé: &quot; + cacheConfig.isEnabled());
        if (cacheConfig.isEnabled()) {
            System.out.println(&quot;Initialisation du cache (simulation)...&quot;);
        } else {
            System.out.println(&quot;Le cache est désactivé.&quot;);
        }
        System.out.println(&quot;-------------------------&quot;);
    }
}
</div></div></div></section></section><section class="chapter"><h3 id="conseils-suppl-mentaires" data-toc="conseils-suppl-mentaires">Conseils Suppl&eacute;mentaires</h3><ul class="list _bullet" id="f5ya97_293"><li class="list__item" id="f5ya97_295"><p id="f5ya97_298"><span class="control" id="f5ya97_299">Priorit&eacute; des Sources de Configuration</span>: Rappelez-vous l'ordre de priorit&eacute; de Spring Boot. Les variables d'environnement syst&egrave;me et les propri&eacute;t&eacute;s syst&egrave;me (o&ugrave; <code class="code" id="f5ya97_300">java-dotenv</code> charge les valeurs) ont une priorit&eacute; plus &eacute;lev&eacute;e que <code class="code" id="f5ya97_301">application.properties</code>. Cela signifie qu'une variable d&eacute;finie dans <code class="code" id="f5ya97_302">.env</code> &eacute;crasera la m&ecirc;me variable d&eacute;finie dans <code class="code" id="f5ya97_303">application.properties</code>.</p></li><li class="list__item" id="f5ya97_296"><p id="f5ya97_304"><span class="control" id="f5ya97_305">Alternatives</span>: Pour des environnements de production complexes, consid&eacute;rez des solutions plus robustes comme Spring Cloud Config Server, HashiCorp Vault, ou les syst&egrave;mes de gestion de secrets int&eacute;gr&eacute;s aux plateformes cloud (AWS Secrets Manager, Azure Key Vault, Kubernetes Secrets). Le fichier <code class="code" id="f5ya97_306">.env</code> reste excellent pour le d&eacute;veloppement local et les configurations simples.</p></li><li class="list__item" id="f5ya97_297"><p id="f5ya97_307"><span class="control" id="f5ya97_308">Validation</span>: Pour les classes <code class="code" id="f5ya97_309">@ConfigurationProperties</code>, ajoutez la d&eacute;pendance <code class="code" id="f5ya97_310">spring-boot-starter-validation</code> et utilisez les annotations de validation JSR-303 (comme <code class="code" id="f5ya97_311">@NotEmpty</code>, <code class="code" id="f5ya97_312">@Min</code>, <code class="code" id="f5ya97_313">@Max</code>, <code class="code" id="f5ya97_314">@Pattern</code>) sur les champs pour vous assurer que les configurations sont valides au d&eacute;marrage.</p></li></ul><p id="f5ya97_294">En r&eacute;sum&eacute;, bien que Spring Boot n'int&egrave;gre pas nativement le support des fichiers <code class="code" id="f5ya97_315">.env</code>, l'utilisation de biblioth&egrave;ques comme <code class="code" id="f5ya97_316">java-dotenv</code> permet d'adopter facilement ce pattern de configuration populaire, particuli&egrave;rement utile pour la gestion des secrets et la configuration locale en d&eacute;veloppement, tout en s'int&eacute;grant harmonieusement avec les m&eacute;canismes de configuration standard de Spring Boot comme <code class="code" id="f5ya97_317">@Value</code> et <code class="code" id="f5ya97_318">@ConfigurationProperties</code>.</p></section></section><div class="last-modified">Last modified: 14 mai 2025</div><div data-feedback-placeholder="true"></div><div class="navigation-links _bottom"><a href="004-00-la-configuration.html" class="navigation-links__prev">La configuration</a><a href="005-00-les-sessions.html" class="navigation-links__next">Les sessions</a></div></article><div id="disqus_thread"></div></div></section></main></div><script src="https://resources.jetbrains.com/writerside/apidoc/6.22.0-b725/app.js"></script></body></html>