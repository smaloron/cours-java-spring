<!DOCTYPE html SYSTEM "about:legacy-compat">
<html lang="en-US" data-preset="contrast" data-primary-color="#307FFF" data-resizable-sidebar="true"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="UTF-8"><meta name="robots" content="noindex"><meta name="built-on" content="2025-05-13T07:33:30.090674"><title>Les messages flash | Spring</title><script type="application/json" id="virtual-toc-data">[{"id":"fonctionnement-technique-simplifi","level":0,"title":"Fonctionnement Technique (Simplifié)","anchor":"#fonctionnement-technique-simplifi"},{"id":"impl-mentation-dans-spring-boot","level":0,"title":"Implémentation dans Spring Boot","anchor":"#impl-mentation-dans-spring-boot"},{"id":"consommation-dans-thymeleaf","level":0,"title":"Consommation dans Thymeleaf","anchor":"#consommation-dans-thymeleaf"},{"id":"factorisation-et-bonnes-pratiques","level":0,"title":"Factorisation et Bonnes Pratiques","anchor":"#factorisation-et-bonnes-pratiques"},{"id":"cas-d-utilisation-courants","level":0,"title":"Cas d\u0027Utilisation Courants","anchor":"#cas-d-utilisation-courants"},{"id":"exercices-pratiques","level":0,"title":"Exercices Pratiques","anchor":"#exercices-pratiques"},{"id":"conclusion","level":0,"title":"Conclusion","anchor":"#conclusion"}]</script><script type="application/json" id="topic-shortcuts"></script><link href="https://resources.jetbrains.com/writerside/apidoc/6.22.0-b725/app.css" rel="stylesheet"><meta name="msapplication-TileColor" content="#000000"><link rel="apple-touch-icon" sizes="180x180" href="https://jetbrains.com/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="https://jetbrains.com/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="https://jetbrains.com/favicon-16x16.png"><meta name="msapplication-TileImage" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-144x144.png"><meta name="msapplication-square70x70logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-70x70.png"><meta name="msapplication-square150x150logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-150x150.png"><meta name="msapplication-wide310x150logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-310x150.png"><meta name="msapplication-square310x310logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-310x310.png"><meta name="image" content=""><!-- Open Graph --><meta property="og:title" content="Les messages flash | Spring"><meta property="og:description" content=""><meta property="og:image" content=""><meta property="og:site_name" content="Spring Help"><meta property="og:type" content="website"><meta property="og:locale" content="en_US"><meta property="og:url" content="writerside-documentation/005-00-les-messages-flash.html"><!-- End Open Graph --><!-- Twitter Card --><meta name="twitter:card" content="summary_large_image"><meta name="twitter:site" content=""><meta name="twitter:title" content="Les messages flash | Spring"><meta name="twitter:description" content=""><meta name="twitter:creator" content=""><meta name="twitter:image:src" content=""><!-- End Twitter Card --><!-- Schema.org WebPage --><script type="application/ld+json">{
    "@context": "http://schema.org",
    "@type": "WebPage",
    "@id": "writerside-documentation/005-00-les-messages-flash.html#webpage",
    "url": "writerside-documentation/005-00-les-messages-flash.html",
    "name": "Les messages flash | Spring",
    "description": "",
    "image": "",
    "inLanguage":"en-US"
}</script><!-- End Schema.org --><!-- Schema.org WebSite --><script type="application/ld+json">{
    "@type": "WebSite",
    "@id": "writerside-documentation/#website",
    "url": "writerside-documentation/",
    "name": "Spring Help"
}</script><!-- End Schema.org --></head><body data-id="005-00-Les-messages-flash" data-main-title="Les messages flash" data-article-props="{&quot;seeAlsoStyle&quot;:&quot;links&quot;}" data-template="article" data-breadcrumbs=""><div class="wrapper"><main class="panel _main"><header class="panel__header"><div class="container"><h3>Spring  Help</h3><div class="panel-trigger"></div></div></header><section class="panel__content"><div class="container"><article class="article" data-shortcut-switcher="inactive"><h1 data-toc="005-00-Les-messages-flash" id="005-00-Les-messages-flash.md">Les messages flash</h1><p id="-q5rv9b_3">Dans le d&eacute;veloppement d'applications web, il est fr&eacute;quent de devoir afficher des messages de notification temporaires &agrave; l'utilisateur apr&egrave;s une action. Par exemple, apr&egrave;s la soumission r&eacute;ussie d'un formulaire, on souhaite informer l'utilisateur que &quot;L'op&eacute;ration a &eacute;t&eacute; r&eacute;alis&eacute;e avec succ&egrave;s&quot;.</p><p id="-q5rv9b_4">Le pattern <span class="control" id="-q5rv9b_15">Post/Redirect/Get (PRG)</span> est une bonne pratique courante pour &eacute;viter les probl&egrave;mes de double soumission de formulaire. Apr&egrave;s une requ&ecirc;te POST (par exemple, la sauvegarde de donn&eacute;es), l'application redirige l'utilisateur vers une page via une requ&ecirc;te GET (par exemple, la page de liste des &eacute;l&eacute;ments).</p><p id="-q5rv9b_5">Cependant, cette redirection pose un d&eacute;fi : comment transmettre une information (comme un message de succ&egrave;s ou d'erreur) de la requ&ecirc;te POST initiale &agrave; la requ&ecirc;te GET suivante, sans que cette information ne persiste ind&eacute;finiment ?</p><p id="-q5rv9b_6">C'est l&agrave; qu'interviennent les <span class="control" id="-q5rv9b_16">messages flash</span> (ou &quot;flash attributes&quot;). Ce sont des attributs stock&eacute;s temporairement ( g&eacute;n&eacute;ralement dans la session HTTP) avant la redirection et rendus disponibles <span class="emphasis" id="-q5rv9b_17">uniquement</span> pour la requ&ecirc;te <span class="emphasis" id="-q5rv9b_18">imm&eacute;diatement</span> suivante (celle apr&egrave;s la redirection). Une fois lus, ils sont automatiquement supprim&eacute;s.</p><p id="-q5rv9b_7">Ce m&eacute;canisme permet d'afficher des notifications contextuelles apr&egrave;s une action, de mani&egrave;re propre et d&eacute;coupl&eacute;e.</p><section class="chapter"><h2 id="fonctionnement-technique-simplifi" data-toc="fonctionnement-technique-simplifi">Fonctionnement Technique (Simplifi&eacute;)</h2><ol class="list _decimal" id="-q5rv9b_19" type="1"><li class="list__item" id="-q5rv9b_20"><p id="-q5rv9b_27"><span class="control" id="-q5rv9b_28">Requ&ecirc;te POST :</span> Le contr&ocirc;leur traite la requ&ecirc;te (ex: sauvegarde en base).</p></li><li class="list__item" id="-q5rv9b_21"><p id="-q5rv9b_29"><span class="control" id="-q5rv9b_30">Ajout du Message Flash :</span> Avant de d&eacute;clencher la redirection, le contr&ocirc;leur ajoute un ou plusieurs attributs &quot; flash&quot; via un m&eacute;canisme fourni par Spring. Ces attributs sont temporairement stock&eacute;s, souvent dans la session HTTP associ&eacute;e &agrave; l'utilisateur.</p></li><li class="list__item" id="-q5rv9b_22"><p id="-q5rv9b_31"><span class="control" id="-q5rv9b_32">Redirection (R&eacute;ponse 302) :</span> Le serveur renvoie une r&eacute;ponse de redirection au navigateur.</p></li><li class="list__item" id="-q5rv9b_23"><p id="-q5rv9b_33"><span class="control" id="-q5rv9b_34">Requ&ecirc;te GET :</span> Le navigateur effectue une nouvelle requ&ecirc;te GET vers l'URL de redirection.</p></li><li class="list__item" id="-q5rv9b_24"><p id="-q5rv9b_35"><span class="control" id="-q5rv9b_36">R&eacute;cup&eacute;ration et Exposition :</span> Spring intercepte cette requ&ecirc;te, r&eacute;cup&egrave;re les attributs flash depuis le stockage temporaire (session), les ajoute au <code class="code" id="-q5rv9b_37">Model</code> de la requ&ecirc;te courante, puis les <span class="emphasis" id="-q5rv9b_38">supprime</span> du stockage temporaire.</p></li><li class="list__item" id="-q5rv9b_25"><p id="-q5rv9b_39"><span class="control" id="-q5rv9b_40">Rendu de la Vue :</span> La vue (ex: page Thymeleaf) peut acc&eacute;der &agrave; ces attributs flash comme n'importe quel autre attribut du <code class="code" id="-q5rv9b_41">Model</code> pour les afficher.</p></li><li class="list__item" id="-q5rv9b_26"><p id="-q5rv9b_42"><span class="control" id="-q5rv9b_43">Requ&ecirc;tes Suivantes :</span> Lors des requ&ecirc;tes ult&eacute;rieures, ces attributs flash ne seront plus pr&eacute;sents dans le <code class="code" id="-q5rv9b_44">Model</code> ni dans la session.</p></li></ol></section><section class="chapter"><h2 id="impl-mentation-dans-spring-boot" data-toc="impl-mentation-dans-spring-boot">Impl&eacute;mentation dans Spring Boot</h2><p id="-q5rv9b_45">Spring MVC facilite grandement l'utilisation des messages flash gr&acirc;ce &agrave; l'interface <code class="code" id="-q5rv9b_48">RedirectAttributes</code>.</p><section class="chapter"><h3 id="injection-de-redirectattributes" data-toc="injection-de-redirectattributes">Injection de <code class="code" id="-q5rv9b_54">RedirectAttributes</code></h3><p id="-q5rv9b_50">Pour ajouter des messages flash dans une m&eacute;thode de contr&ocirc;leur qui effectue une redirection, il suffit d'ajouter un param&egrave;tre de type <code class="code" id="-q5rv9b_55">RedirectAttributes</code> &agrave; la signature de la m&eacute;thode. Spring injectera automatiquement une instance appropri&eacute;e.</p><div class="code-block" data-lang="java">
package fr.formation.spring.controller;

import org.springframework.stereotype.Controller;
import org.springframework.web.bind.annotation.PostMapping;
import org.springframework.web.bind.annotation.RequestMapping;
// Importation de RedirectAttributes
import org.springframework.web.servlet.mvc.support.RedirectAttributes;
import org.springframework.web.servlet.view.RedirectView;

@Controller
@RequestMapping(&quot;/products&quot;)
public class ProductController {

    @PostMapping(&quot;/save&quot;)
    public RedirectView saveProduct(
            // Le nom de la variable est `productData` pour l'exemple,
            // mais il contiendrait les données du produit venant du formulaire.
            /* @ModelAttribute Product productData, */
            // Injection de RedirectAttributes
            RedirectAttributes redirectAttributes) {

        // Simulation d'une logique métier (sauvegarde, etc.)
        boolean success = performSaveOperation(/* productData */);

        if (success) {
            // Ajout d'un message flash en cas de succès
            String successMessage = &quot;Produit ajouté avec succès !&quot;;
            // La clé &quot;successMessage&quot; sera utilisée dans la vue Thymeleaf.
            redirectAttributes.addFlashAttribute(&quot;successMessage&quot;, successMessage);
        } else {
            // Ajout d'un message flash en cas d'échec
            String errorMessage = &quot;Erreur lors de l'ajout du produit.&quot;;
            redirectAttributes.addFlashAttribute(&quot;errorMessage&quot;, errorMessage);
        }

        // Redirection vers la page de liste des produits
        // Note : On peut aussi retourner &quot;redirect:/products/list&quot;
        return new RedirectView(&quot;/products/list&quot;);
    }

    // Méthode pour afficher la liste (cible de la redirection)
    // @GetMapping(&quot;/list&quot;) ... 

    // Méthode interne simulant l'opération
    private boolean performSaveOperation() {
        // Logique métier ici...
        // Retourne true pour simuler un succès dans cet exemple
        return true;
    }
}
</div><p id="-q5rv9b_52"><span class="control" id="-q5rv9b_56">Explication :</span></p><ul class="list _bullet" id="-q5rv9b_53"><li class="list__item" id="-q5rv9b_57"><p id="-q5rv9b_60"><code class="code" id="-q5rv9b_61">RedirectAttributes</code> est inject&eacute; dans la m&eacute;thode <code class="code" id="-q5rv9b_62">saveProduct</code>.</p></li><li class="list__item" id="-q5rv9b_58"><p id="-q5rv9b_63"><code class="code" id="-q5rv9b_64">redirectAttributes.addFlashAttribute(&quot;key&quot;, value)</code> est la m&eacute;thode cl&eacute;. Elle stocke l'objet <code class="code" id="-q5rv9b_65">value</code> sous le nom <code class="code" id="-q5rv9b_66">key</code> de mani&egrave;re temporaire pour la prochaine requ&ecirc;te apr&egrave;s redirection.</p></li><li class="list__item" id="-q5rv9b_59"><p id="-q5rv9b_67">La m&eacute;thode retourne soit un <code class="code" id="-q5rv9b_68">RedirectView</code>, soit une cha&icirc;ne de caract&egrave;res pr&eacute;fix&eacute;e par <code class="code" id="-q5rv9b_69">&quot;redirect:&quot;</code> (ex: <code class="code" id="-q5rv9b_70">&quot;redirect:/products/list&quot;</code>), ce qui d&eacute;clenche la redirection.</p></li></ul></section><section class="chapter"><h3 id="types-de-messages" data-toc="types-de-messages">Types de Messages</h3><p id="-q5rv9b_71">Il est courant de vouloir afficher diff&eacute;rents types de messages (succ&egrave;s, erreur, information, avertissement) avec des styles visuels distincts. La mani&egrave;re la plus simple est d'utiliser des cl&eacute;s diff&eacute;rentes pour chaque type :</p><ul class="list _bullet" id="-q5rv9b_72"><li class="list__item" id="-q5rv9b_74"><p id="-q5rv9b_78"><code class="code" id="-q5rv9b_79">successMessage</code></p></li><li class="list__item" id="-q5rv9b_75"><p id="-q5rv9b_80"><code class="code" id="-q5rv9b_81">errorMessage</code></p></li><li class="list__item" id="-q5rv9b_76"><p id="-q5rv9b_82"><code class="code" id="-q5rv9b_83">infoMessage</code></p></li><li class="list__item" id="-q5rv9b_77"><p id="-q5rv9b_84"><code class="code" id="-q5rv9b_85">warningMessage</code></p></li></ul><p id="-q5rv9b_73">On ajoutera l'attribut flash correspondant &agrave; la situation.</p></section></section><section class="chapter"><h2 id="consommation-dans-thymeleaf" data-toc="consommation-dans-thymeleaf">Consommation dans Thymeleaf</h2><p id="-q5rv9b_86">Les attributs flash ajout&eacute;s via <code class="code" id="-q5rv9b_91">RedirectAttributes</code> sont automatiquement disponibles dans le <code class="code" id="-q5rv9b_92">Model</code> de la requ&ecirc;te GET qui suit la redirection. On peut donc y acc&eacute;der dans Thymeleaf comme n'importe quelle variable du mod&egrave;le.</p><p id="-q5rv9b_87">Il est crucial de v&eacute;rifier l'existence de l'attribut avant de tenter de l'afficher, car il ne sera pr&eacute;sent que lors de cette <span class="emphasis" id="-q5rv9b_93">unique</span> requ&ecirc;te post-redirection.</p><div class="code-block" data-lang="markup">
&lt;!DOCTYPE html&gt;
&lt;html xmlns:th=&quot;http://www.thymeleaf.org&quot;&gt;
&lt;head&gt;
    &lt;title&gt;Liste des Produits&lt;/title&gt;
    &lt;!-- Inclure ici vos CSS pour styliser les messages --&gt;
    &lt;style&gt;
        .alert {
            padding: 15px;
            margin-bottom: 20px;
            border: 1px solid transparent;
            border-radius: 4px;
        }

        .alert-success {
            color: #155724;
            background-color: #d4edda;
            border-color: #c3e6cb;
        }

        .alert-danger {
            color: #721c24;
            background-color: #f8d7da;
            border-color: #f5c6cb;
        }

        .alert-info {
            color: #0c5460;
            background-color: #d1ecf1;
            border-color: #bee5eb;
        }

        .alert-warning {
            color: #856404;
            background-color: #fff3cd;
            border-color: #ffeeba;
        }
    &lt;/style&gt;
&lt;/head&gt;
&lt;body&gt;

&lt;h1&gt;Liste des Produits&lt;/h1&gt;

&lt;!-- Affichage conditionnel du message de succès --&gt;
&lt;div th:if=&quot;${successMessage}&quot; class=&quot;alert alert-success&quot; role=&quot;alert&quot;&gt;
    &lt;p th:text=&quot;${successMessage}&quot;&gt;&lt;/p&gt;
&lt;/div&gt;

&lt;!-- Affichage conditionnel du message d'erreur --&gt;
&lt;div th:if=&quot;${errorMessage}&quot; class=&quot;alert alert-danger&quot; role=&quot;alert&quot;&gt;
    &lt;p th:text=&quot;${errorMessage}&quot;&gt;&lt;/p&gt;
&lt;/div&gt;

&lt;!-- Affichage conditionnel du message d'information --&gt;
&lt;div th:if=&quot;${infoMessage}&quot; class=&quot;alert alert-info&quot; role=&quot;alert&quot;&gt;
    &lt;p th:text=&quot;${infoMessage}&quot;&gt;&lt;/p&gt;
&lt;/div&gt;

&lt;!-- Affichage conditionnel du message d'avertissement --&gt;
&lt;div th:if=&quot;${warningMessage}&quot; class=&quot;alert alert-warning&quot; role=&quot;alert&quot;&gt;
    &lt;p th:text=&quot;${warningMessage}&quot;&gt;&lt;/p&gt;
&lt;/div&gt;

&lt;!-- Reste de la page (tableau des produits, etc.) --&gt;
&lt;table&gt;
    &lt;!-- ... contenu de la liste ... --&gt;
&lt;/table&gt;

&lt;/body&gt;
&lt;/html&gt;
</div><p id="-q5rv9b_89"><span class="control" id="-q5rv9b_94">Explication :</span></p><ul class="list _bullet" id="-q5rv9b_90"><li class="list__item" id="-q5rv9b_95"><p id="-q5rv9b_98"><code class="code" id="-q5rv9b_99">th:if=&quot;${successMessage}&quot;</code>: Cet attribut Thymeleaf v&eacute;rifie si la variable <code class="code" id="-q5rv9b_100">successMessage</code> existe et n'est pas nulle (ou fausse, ou une collection/cha&icirc;ne vide selon le contexte de l'expression). Le <code class="code" id="-q5rv9b_101">div</code> ne sera rendu que si la condition est vraie.</p></li><li class="list__item" id="-q5rv9b_96"><p id="-q5rv9b_102"><code class="code" id="-q5rv9b_103">th:text=&quot;${successMessage}&quot;</code>: Affiche la valeur du message flash.</p></li><li class="list__item" id="-q5rv9b_97"><p id="-q5rv9b_104">Des classes CSS (<code class="code" id="-q5rv9b_105">alert</code>, <code class="code" id="-q5rv9b_106">alert-success</code>, <code class="code" id="-q5rv9b_107">alert-danger</code>, etc. - inspir&eacute;es de Bootstrap) sont utilis&eacute;es pour le style. Il faut d&eacute;finir ces classes dans une feuille de style CSS.</p></li></ul></section><section class="chapter"><h2 id="factorisation-et-bonnes-pratiques" data-toc="factorisation-et-bonnes-pratiques">Factorisation et Bonnes Pratiques</h2><p id="-q5rv9b_108">R&eacute;p&eacute;ter les appels <code class="code" id="-q5rv9b_112">redirectAttributes.addFlashAttribute(...)</code> dans de nombreuses m&eacute;thodes de contr&ocirc;leur peut devenir fastidieux et violer le principe DRY (Don't Repeat Yourself). Plusieurs approches existent pour factoriser ce code.</p><section class="chapter"><h3 id="m-thode-utilitaire-dans-le-contr-leur" data-toc="m-thode-utilitaire-dans-le-contr-leur">M&eacute;thode Utilitaire dans le Contr&ocirc;leur</h3><p id="-q5rv9b_113">Une approche simple consiste &agrave; cr&eacute;er des m&eacute;thodes priv&eacute;es au sein du contr&ocirc;leur (ou d'une classe de base si plusieurs contr&ocirc;leurs partagent cette logique).</p><div class="code-block" data-lang="java">
package fr.formation.spring.controller;

import org.springframework.stereotype.Controller;
import org.springframework.web.bind.annotation.PostMapping;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.servlet.mvc.support.RedirectAttributes;
import org.springframework.web.servlet.view.RedirectView;

@Controller
@RequestMapping(&quot;/products&quot;)
public class ProductController {

    @PostMapping(&quot;/save&quot;)
    public RedirectView saveProduct(
            RedirectAttributes redirectAttributes) {

        boolean success = performSaveOperation();

        if (success) {
            // Appel de la méthode utilitaire pour le succès
            addFlashSuccessMessage(redirectAttributes, &quot;Produit ajouté avec succès !&quot;);
        } else {
            // Appel de la méthode utilitaire pour l'erreur
            addFlashErrorMessage(redirectAttributes, &quot;Erreur lors de l'ajout du produit.&quot;);
        }

        return new RedirectView(&quot;/products/list&quot;);
    }

    // ... (autres méthodes comme @GetMapping(&quot;/list&quot;))

    // --- Méthodes utilitaires pour les messages flash ---

    private void addFlashSuccessMessage(RedirectAttributes attributes, String message) {
        attributes.addFlashAttribute(&quot;successMessage&quot;, message);
    }

    private void addFlashErrorMessage(RedirectAttributes attributes, String message) {
        attributes.addFlashAttribute(&quot;errorMessage&quot;, message);
    }

    private void addFlashInfoMessage(RedirectAttributes attributes, String message) {
        attributes.addFlashAttribute(&quot;infoMessage&quot;, message);
    }

    private void addFlashWarningMessage(RedirectAttributes attributes, String message) {
        attributes.addFlashAttribute(&quot;warningMessage&quot;, message);
    }

    // Méthode interne simulant l'opération
    private boolean performSaveOperation() {
        return true;
    }
}
</div></section><section class="chapter"><h3 id="composant-utilitaire-service" data-toc="composant-utilitaire-service">Composant Utilitaire (Service)</h3><p id="-q5rv9b_115">Pour une r&eacute;utilisation plus large &agrave; travers l'application, on peut cr&eacute;er un composant Spring d&eacute;di&eacute;.</p><div class="code-block" data-lang="java">
package fr.formation.spring.util;

import org.springframework.stereotype.Component;
import org.springframework.web.servlet.mvc.support.RedirectAttributes;

@Component // Déclare ce bean comme un composant Spring
public class FlashMessageHelper {

    public void addSuccessMessage(RedirectAttributes attributes, String message) {
        attributes.addFlashAttribute(&quot;successMessage&quot;, message);
    }

    public void addErrorMessage(RedirectAttributes attributes, String message) {
        attributes.addFlashAttribute(&quot;errorMessage&quot;, message);
    }

    public void addInfoMessage(RedirectAttributes attributes, String message) {
        attributes.addFlashAttribute(&quot;infoMessage&quot;, message);
    }

    public void addWarningMessage(RedirectAttributes attributes, String message) {
        attributes.addFlashAttribute(&quot;warningMessage&quot;, message);
    }
}
</div><p id="-q5rv9b_117">Et l'injecter dans les contr&ocirc;leurs :</p><div class="code-block" data-lang="java">
package fr.formation.spring.controller;

import fr.formation.spring.util.FlashMessageHelper; // Importation
import org.springframework.beans.factory.annotation.Autowired; // Importation
import org.springframework.stereotype.Controller;
import org.springframework.web.bind.annotation.PostMapping;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.servlet.mvc.support.RedirectAttributes;
import org.springframework.web.servlet.view.RedirectView;

@Controller
@RequestMapping(&quot;/products&quot;)
public class ProductController {

    // Injection du helper par Autowired
    @Autowired
    private FlashMessageHelper flashHelper;

    @PostMapping(&quot;/save&quot;)
    public RedirectView saveProduct(
            RedirectAttributes redirectAttributes) {

        boolean success = performSaveOperation();

        if (success) {
            // Utilisation du helper injecté
            flashHelper.addSuccessMessage(redirectAttributes, &quot;Produit ajouté avec succès !&quot;);
        } else {
            flashHelper.addErrorMessage(redirectAttributes, &quot;Erreur lors de l'ajout du produit.&quot;);
        }

        return new RedirectView(&quot;/products/list&quot;);
    }

    // ... autres méthodes

    private boolean performSaveOperation() {
        return true;
    }
}
</div><p id="-q5rv9b_119">Cette seconde approche est g&eacute;n&eacute;ralement pr&eacute;f&eacute;rable car elle favorise la s&eacute;paration des pr&eacute;occupations et la r&eacute;utilisabilit&eacute;.</p></section><section class="chapter"><h3 id="bonnes-pratiques-et-conseils" data-toc="bonnes-pratiques-et-conseils">Bonnes Pratiques et Conseils</h3><ul class="list _bullet" id="-q5rv9b_120"><li class="list__item" id="-q5rv9b_121"><p id="-q5rv9b_127"><span class="control" id="-q5rv9b_128">Consistance des Cl&eacute;s :</span> Utiliser des noms de cl&eacute;s coh&eacute;rents dans toute l'application (<code class="code" id="-q5rv9b_129">successMessage</code>, <code class="code" id="-q5rv9b_130">errorMessage</code>, etc.).</p></li><li class="list__item" id="-q5rv9b_122"><p id="-q5rv9b_131"><span class="control" id="-q5rv9b_132">Messages Clairs :</span> R&eacute;diger des messages concis et compr&eacute;hensibles pour l'utilisateur final. Penser &agrave; l'internationalisation si n&eacute;cessaire (en utilisant les <code class="code" id="-q5rv9b_133">MessageSource</code> de Spring).</p></li><li class="list__item" id="-q5rv9b_123"><p id="-q5rv9b_134"><span class="control" id="-q5rv9b_135">Styling Centralis&eacute; :</span> D&eacute;finir les styles CSS pour les messages dans un fichier CSS global pour une apparence uniforme.</p></li><li class="list__item" id="-q5rv9b_124"><p id="-q5rv9b_136"><span class="control" id="-q5rv9b_137">Ne pas Abuser :</span> Les messages flash sont pour des notifications <span class="emphasis" id="-q5rv9b_138">temporaires</span> li&eacute;es &agrave; une action venant d'&ecirc;tre effectu&eacute;e via redirection. Ne pas les utiliser pour des informations permanentes ou pour passer des donn&eacute;es m&eacute;tier complexes.</p></li><li class="list__item" id="-q5rv9b_125"><p id="-q5rv9b_139"><span class="control" id="-q5rv9b_140">Accessibilit&eacute; :</span> Penser &agrave; rendre les messages accessibles (par exemple, en utilisant les attributs ARIA appropri&eacute;s comme <code class="code" id="-q5rv9b_141">role=&quot;alert&quot;</code> dans le HTML).</p></li><li class="list__item" id="-q5rv9b_126"><p id="-q5rv9b_142"><span class="control" id="-q5rv9b_143">Alternative :</span> Pour les erreurs de validation de formulaire <span class="emphasis" id="-q5rv9b_144">sans</span> redirection imm&eacute;diate (rester sur la m&ecirc;me page), le m&eacute;canisme de <code class="code" id="-q5rv9b_145">BindingResult</code> de Spring est souvent plus adapt&eacute; que les messages flash.</p></li></ul></section></section><section class="chapter"><h2 id="cas-d-utilisation-courants" data-toc="cas-d-utilisation-courants">Cas d'Utilisation Courants</h2><ul class="list _bullet" id="-q5rv9b_146"><li class="list__item" id="-q5rv9b_147"><p id="-q5rv9b_151">Confirmation de cr&eacute;ation, modification ou suppression d'une entit&eacute; (ex: &quot;Utilisateur cr&eacute;&eacute; avec succ&egrave;s&quot;).</p></li><li class="list__item" id="-q5rv9b_148"><p id="-q5rv9b_152">Notification d'&eacute;chec d'une op&eacute;ration (ex: &quot;Impossible de supprimer le produit car il est li&eacute; &agrave; des commandes&quot;).</p></li><li class="list__item" id="-q5rv9b_149"><p id="-q5rv9b_153">Message informatif apr&egrave;s une action (ex: &quot;Votre mot de passe a &eacute;t&eacute; r&eacute;initialis&eacute;. Veuillez v&eacute;rifier vos emails.&quot;).</p></li><li class="list__item" id="-q5rv9b_150"><p id="-q5rv9b_154">Confirmation d'envoi de formulaire (ex: &quot;Votre message a bien &eacute;t&eacute; envoy&eacute;.&quot;).</p></li></ul></section><section class="chapter"><h2 id="exercices-pratiques" data-toc="exercices-pratiques">Exercices Pratiques</h2><section class="chapter"><h3 id="exercice-1-message-de-succ-s-simple" data-toc="exercice-1-message-de-succ-s-simple">Exercice 1 : Message de Succ&egrave;s Simple</h3><p id="-q5rv9b_157"><span class="control" id="-q5rv9b_160">&Eacute;nonc&eacute; :</span></p><ol class="list _decimal" id="-q5rv9b_158" type="1"><li class="list__item" id="-q5rv9b_161"><p id="-q5rv9b_168">Cr&eacute;ez un contr&ocirc;leur <code class="code" id="-q5rv9b_169">TaskController</code> dans le package <code class="code" id="-q5rv9b_170">fr.formation.spring.controller</code>.</p></li><li class="list__item" id="-q5rv9b_162"><p id="-q5rv9b_171">Ajoutez une m&eacute;thode GET pour afficher un formulaire simple &agrave; l'URL <code class="code" id="-q5rv9b_172">/tasks/new</code> (vue <code class="code" id="-q5rv9b_173">task-form.html</code>). Le formulaire aura un seul champ texte <code class="code" id="-q5rv9b_174">description</code> et un bouton &quot;Ajouter&quot;.</p></li><li class="list__item" id="-q5rv9b_163"><p id="-q5rv9b_175">Ajoutez une m&eacute;thode POST pour traiter la soumission du formulaire &agrave; l'URL <code class="code" id="-q5rv9b_176">/tasks/save</code>.</p></li><li class="list__item" id="-q5rv9b_164"><p id="-q5rv9b_177">Dans la m&eacute;thode POST, simulez une sauvegarde r&eacute;ussie. Ajoutez un message flash de succ&egrave;s &quot;T&acirc;che ajout&eacute;e avec succ&egrave;s !&quot; en utilisant <code class="code" id="-q5rv9b_178">RedirectAttributes</code>.</p></li><li class="list__item" id="-q5rv9b_165"><p id="-q5rv9b_179">Redirigez vers une page de liste (fictive pour l'instant) &agrave; l'URL <code class="code" id="-q5rv9b_180">/tasks/list</code>.</p></li><li class="list__item" id="-q5rv9b_166"><p id="-q5rv9b_181">Cr&eacute;ez une m&eacute;thode GET pour l'URL <code class="code" id="-q5rv9b_182">/tasks/list</code> qui retourne une vue <code class="code" id="-q5rv9b_183">task-list.html</code>.</p></li><li class="list__item" id="-q5rv9b_167"><p id="-q5rv9b_184">Dans <code class="code" id="-q5rv9b_185">task-list.html</code>, affichez le message flash de succ&egrave;s s'il est pr&eacute;sent, en utilisant Thymeleaf et une classe CSS <code class="code" id="-q5rv9b_186">alert-success</code>.</p></li></ol><section class="chapter"><div class="collapse"><div class="collapse__title"><h4 id="correction-exercice-1" data-toc="correction-exercice-1"><span class="control" id="-q5rv9b_194">Correction Exercice 1 :</span></h4></div><div class="collapse__content"><p id="-q5rv9b_188"><span class="control" id="-q5rv9b_195"><code class="code" id="-q5rv9b_196">TaskController.java</code></span></p><div class="code-block" data-lang="java">
package fr.formation.spring.controller;

import org.springframework.stereotype.Controller;
import org.springframework.ui.Model;
import org.springframework.web.bind.annotation.GetMapping;
import org.springframework.web.bind.annotation.PostMapping;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.bind.annotation.RequestParam;
import org.springframework.web.servlet.mvc.support.RedirectAttributes;
import org.springframework.web.servlet.view.RedirectView;

@Controller
@RequestMapping(&quot;/tasks&quot;)
public class TaskController {

    // Affiche le formulaire
    @GetMapping(&quot;/new&quot;)
    public String showTaskForm() {
        return &quot;task-form&quot;; // Nom de la vue Thymeleaf
    }

    // Traite la soumission du formulaire
    @PostMapping(&quot;/save&quot;)
    public RedirectView saveTask(
            // Récupère la donnée du formulaire (simplifié ici)
            @RequestParam String description,
            RedirectAttributes redirectAttributes) {

        System.out.println(&quot;Sauvegarde de la tâche : &quot; + description);
        // Simulation d'un succès systématique pour cet exercice
        boolean success = true;

        if (success) {
            // Message de succès
            String successMsg = &quot;Tâche '&quot; + description + &quot;' ajoutée avec succès !&quot;;
            redirectAttributes.addFlashAttribute(&quot;successMessage&quot;, successMsg);
        }
        // Pas de cas d'erreur dans cet exercice simple

        // Redirection vers la liste
        return new RedirectView(&quot;/tasks/list&quot;);
    }

    // Affiche la page de liste (cible de la redirection)
    @GetMapping(&quot;/list&quot;)
    public String showTaskList(Model model) {
        // Ici, on pourrait charger la vraie liste des tâches
        // model.addAttribute(&quot;tasks&quot;, taskService.findAll());
        return &quot;task-list&quot;; // Nom de la vue Thymeleaf
    }
}
</div><p id="-q5rv9b_190"><span class="control" id="-q5rv9b_197"><code class="code" id="-q5rv9b_198">src/main/resources/templates/task-form.html</code></span></p><div class="code-block" data-lang="markup">
&lt;!DOCTYPE html&gt;
&lt;html xmlns:th=&quot;http://www.thymeleaf.org&quot;&gt;
&lt;head&gt;
    &lt;title&gt;Nouvelle Tâche&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
&lt;h1&gt;Ajouter une nouvelle tâche&lt;/h1&gt;
&lt;form th:action=&quot;@{/tasks/save}&quot; method=&quot;post&quot;&gt;
    &lt;div&gt;
        &lt;label for=&quot;desc&quot;&gt;Description:&lt;/label&gt;
        &lt;input type=&quot;text&quot; id=&quot;desc&quot; name=&quot;description&quot; required/&gt;
    &lt;/div&gt;
    &lt;div&gt;
        &lt;button type=&quot;submit&quot;&gt;Ajouter&lt;/button&gt;
    &lt;/div&gt;
&lt;/form&gt;
&lt;/body&gt;
&lt;/html&gt;
</div><p id="-q5rv9b_192"><span class="control" id="-q5rv9b_199"><code class="code" id="-q5rv9b_200">src/main/resources/templates/task-list.html</code></span></p><div class="code-block" data-lang="markup">
&lt;!DOCTYPE html&gt;
&lt;html xmlns:th=&quot;http://www.thymeleaf.org&quot;&gt;
&lt;head&gt;
    &lt;title&gt;Liste des Tâches&lt;/title&gt;
    &lt;style&gt;
        .alert {
            padding: 10px;
            margin-bottom: 15px;
            border: 1px solid transparent;
            border-radius: 4px;
        }

        .alert-success {
            color: #155724;
            background-color: #d4edda;
            border-color: #c3e6cb;
        }
    &lt;/style&gt;
&lt;/head&gt;
&lt;body&gt;
&lt;h1&gt;Liste des Tâches&lt;/h1&gt;

&lt;!-- Affichage du message flash de succès --&gt;
&lt;div th:if=&quot;${successMessage}&quot; class=&quot;alert alert-success&quot; role=&quot;alert&quot;&gt;
    &lt;p th:text=&quot;${successMessage}&quot;&gt;&lt;/p&gt;
&lt;/div&gt;

&lt;!-- Ici viendrait l'affichage de la liste des tâches --&gt;
&lt;p&gt;(Contenu de la liste des tâches...)&lt;/p&gt;

&lt;/body&gt;
&lt;/html&gt;
</div></div></div></section></section><section class="chapter"><h3 id="exercice-2-gestion-des-erreurs" data-toc="exercice-2-gestion-des-erreurs">Exercice 2 : Gestion des Erreurs</h3><p id="-q5rv9b_201"><span class="control" id="-q5rv9b_206">&Eacute;nonc&eacute; :</span></p><ol class="list _decimal" id="-q5rv9b_202" type="1"><li class="list__item" id="-q5rv9b_207"><p id="-q5rv9b_212">Modifiez la m&eacute;thode <code class="code" id="-q5rv9b_213">saveTask</code> du <code class="code" id="-q5rv9b_214">TaskController</code> de l'exercice pr&eacute;c&eacute;dent.</p></li><li class="list__item" id="-q5rv9b_208"><p id="-q5rv9b_215">Si le champ <code class="code" id="-q5rv9b_216">description</code> soumis est vide ou contient uniquement des espaces, consid&eacute;rez cela comme une erreur.</p></li><li class="list__item" id="-q5rv9b_209"><p id="-q5rv9b_217">Dans ce cas d'erreur, ajoutez un message flash d'erreur &quot;La description ne peut pas &ecirc;tre vide.&quot; avec la cl&eacute; <code class="code" id="-q5rv9b_218">errorMessage</code>. Ne sauvegardez pas la t&acirc;che et redirigez toujours vers <code class="code" id="-q5rv9b_219">/tasks/list</code>.</p></li><li class="list__item" id="-q5rv9b_210"><p id="-q5rv9b_220">Si la description est valide, ajoutez le message de succ&egrave;s comme pr&eacute;c&eacute;demment.</p></li><li class="list__item" id="-q5rv9b_211"><p id="-q5rv9b_221">Modifiez la vue <code class="code" id="-q5rv9b_222">task-list.html</code> pour afficher <span class="emphasis" id="-q5rv9b_223">soit</span> le message de succ&egrave;s (avec la classe <code class="code" id="-q5rv9b_224">alert-success</code>), <span class="emphasis" id="-q5rv9b_225">soit</span> le message d'erreur (avec une classe <code class="code" id="-q5rv9b_226">alert-danger</code>), mais jamais les deux en m&ecirc;me temps.</p></li></ol><section class="chapter"><div class="collapse"><div class="collapse__title"><h4 id="correction-exercice-2" data-toc="correction-exercice-2"><span class="control" id="-q5rv9b_233">Correction Exercice 2 :</span></h4></div><div class="collapse__content"><p id="-q5rv9b_228"><span class="control" id="-q5rv9b_234"><code class="code" id="-q5rv9b_235">TaskController.java</code> (M&eacute;thode <code class="code" id="-q5rv9b_236">saveTask</code> modifi&eacute;e)</span></p><div class="code-block" data-lang="java">
    // ... (autres méthodes et imports identiques)

// Traite la soumission du formulaire
@PostMapping(&quot;/save&quot;)
public RedirectView saveTask(
        @RequestParam String description,
        RedirectAttributes redirectAttributes) {

    // Vérification simple de la description
    if (description == null || description.trim().isEmpty()) {
        // Cas d'erreur : description vide
        String errorMsg = &quot;La description de la tâche ne peut pas être vide.&quot;;
        redirectAttributes.addFlashAttribute(&quot;errorMessage&quot;, errorMsg);
    } else {
        // Cas de succès : description valide (simulation)
        System.out.println(&quot;Sauvegarde de la tâche : &quot; + description);
        String successMsg = &quot;Tâche '&quot; + description + &quot;' ajoutée avec succès !&quot;;
        redirectAttributes.addFlashAttribute(&quot;successMessage&quot;, successMsg);
    }

    // Redirection vers la liste dans tous les cas (après ajout du message)
    return new RedirectView(&quot;/tasks/list&quot;);
}

// ... (méthode showTaskList identique)
</div><p id="-q5rv9b_230"><span class="control" id="-q5rv9b_237"><code class="code" id="-q5rv9b_238">src/main/resources/templates/task-list.html</code> (Modifi&eacute;e)</span></p><div class="code-block" data-lang="markup">
&lt;!DOCTYPE html&gt;
&lt;html xmlns:th=&quot;http://www.thymeleaf.org&quot;&gt;
&lt;head&gt;
    &lt;title&gt;Liste des Tâches&lt;/title&gt;
    &lt;style&gt;
        .alert {
            padding: 10px;
            margin-bottom: 15px;
            border: 1px solid transparent;
            border-radius: 4px;
        }

        .alert-success {
            color: #155724;
            background-color: #d4edda;
            border-color: #c3e6cb;
        }

        /* Ajout du style pour les erreurs */
        .alert-danger {
            color: #721c24;
            background-color: #f8d7da;
            border-color: #f5c6cb;
        }
    &lt;/style&gt;
&lt;/head&gt;
&lt;body&gt;
&lt;h1&gt;Liste des Tâches&lt;/h1&gt;

&lt;!-- Affichage conditionnel: priorité à l'erreur s'il existe --&gt;
&lt;div th:if=&quot;${errorMessage}&quot; class=&quot;alert alert-danger&quot; role=&quot;alert&quot;&gt;
    &lt;p th:text=&quot;${errorMessage}&quot;&gt;&lt;/p&gt;
&lt;/div&gt;

&lt;!-- Affichage du succès SEULEMENT s'il n'y a pas de message d'erreur --&gt;
&lt;div th:if=&quot;${successMessage and not errorMessage}&quot; class=&quot;alert alert-success&quot; role=&quot;alert&quot;&gt;
    &lt;p th:text=&quot;${successMessage}&quot;&gt;&lt;/p&gt;
&lt;/div&gt;

&lt;!-- Ici viendrait l'affichage de la liste des tâches --&gt;
&lt;p&gt;(Contenu de la liste des tâches...)&lt;/p&gt;

&lt;/body&gt;
&lt;/html&gt;
</div><p id="-q5rv9b_232"><span class="emphasis" id="-q5rv9b_239">(Note: L'alternative <code class="code" id="-q5rv9b_240">th:unless=&quot;${errorMessage}&quot;</code> pourrait aussi &ecirc;tre utilis&eacute;e dans le second <code class="code" id="-q5rv9b_241">div</code>)</span></p></div></div></section><section class="chapter"><h4 id="exercice-3-factorisation-avec-un-helper" data-toc="exercice-3-factorisation-avec-un-helper">Exercice 3 : Factorisation avec un Helper</h4><p id="-q5rv9b_242"><span class="control" id="-q5rv9b_244">&Eacute;nonc&eacute; :</span></p><ol class="list _decimal" id="-q5rv9b_243" type="1"><li class="list__item" id="-q5rv9b_245"><p id="-q5rv9b_248">Cr&eacute;ez la classe <code class="code" id="-q5rv9b_249">FlashMessageHelper</code> dans <code class="code" id="-q5rv9b_250">fr.formation.spring.util</code> comme montr&eacute; dans la section 5.2.</p></li><li class="list__item" id="-q5rv9b_246"><p id="-q5rv9b_251">Injectez ce <code class="code" id="-q5rv9b_252">FlashMessageHelper</code> dans le <code class="code" id="-q5rv9b_253">TaskController</code>.</p></li><li class="list__item" id="-q5rv9b_247"><p id="-q5rv9b_254">Modifiez la m&eacute;thode <code class="code" id="-q5rv9b_255">saveTask</code> pour utiliser les m&eacute;thodes <code class="code" id="-q5rv9b_256">addSuccessMessage</code> et <code class="code" id="-q5rv9b_257">addErrorMessage</code> du helper au lieu d'appeler directement <code class="code" id="-q5rv9b_258">redirectAttributes.addFlashAttribute</code>.</p></li></ol></section><section class="chapter"><div class="collapse"><div class="collapse__title"><h4 id="correction-exercice-3" data-toc="correction-exercice-3"><span class="control" id="-q5rv9b_265">Correction Exercice 3 :</span></h4></div><div class="collapse__content"><p id="-q5rv9b_260"><span class="control" id="-q5rv9b_266"><code class="code" id="-q5rv9b_267">FlashMessageHelper.java</code></span></p><div class="code-block" data-lang="java">
package fr.formation.spring.util;

import org.springframework.stereotype.Component;
import org.springframework.web.servlet.mvc.support.RedirectAttributes;

@Component
public class FlashMessageHelper {

    public void addSuccessMessage(RedirectAttributes attributes, String message) {
        attributes.addFlashAttribute(&quot;successMessage&quot;, message);
    }

    public void addErrorMessage(RedirectAttributes attributes, String message) {
        attributes.addFlashAttribute(&quot;errorMessage&quot;, message);
    }

    // On pourrait ajouter ici info et warning si besoin
    // public void addInfoMessage(...)
    // public void addWarningMessage(...)
}
</div><p id="-q5rv9b_262"><span class="control" id="-q5rv9b_268"><code class="code" id="-q5rv9b_269">TaskController.java</code> (Modifi&eacute; pour utiliser le Helper)</span></p><div class="code-block" data-lang="java">
package fr.formation.spring.controller;

import fr.formation.spring.util.FlashMessageHelper; // Import du Helper
import org.springframework.beans.factory.annotation.Autowired; // Import Autowired
import org.springframework.stereotype.Controller;
import org.springframework.ui.Model;
import org.springframework.web.bind.annotation.GetMapping;
import org.springframework.web.bind.annotation.PostMapping;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.bind.annotation.RequestParam;
import org.springframework.web.servlet.mvc.support.RedirectAttributes;
import org.springframework.web.servlet.view.RedirectView;

@Controller
@RequestMapping(&quot;/tasks&quot;)
public class TaskController {

    // Injection du Helper
    @Autowired
    private FlashMessageHelper flashHelper;

    @GetMapping(&quot;/new&quot;)
    public String showTaskForm() {
        return &quot;task-form&quot;;
    }

    @PostMapping(&quot;/save&quot;)
    public RedirectView saveTask(
            @RequestParam String description,
            RedirectAttributes redirectAttributes) {

        if (description == null || description.trim().isEmpty()) {
            String errorMsg = &quot;La description de la tâche ne peut pas être vide.&quot;;
            // Utilisation du helper pour le message d'erreur
            flashHelper.addErrorMessage(redirectAttributes, errorMsg);
        } else {
            System.out.println(&quot;Sauvegarde de la tâche : &quot; + description);
            String successMsg = &quot;Tâche '&quot; + description + &quot;' ajoutée avec succès !&quot;;
            // Utilisation du helper pour le message de succès
            flashHelper.addSuccessMessage(redirectAttributes, successMsg);
        }

        return new RedirectView(&quot;/tasks/list&quot;);
    }

    @GetMapping(&quot;/list&quot;)
    public String showTaskList(Model model) {
        return &quot;task-list&quot;;
    }
}
</div><p id="-q5rv9b_264"><span class="emphasis" id="-q5rv9b_270">(Les vues <code class="code" id="-q5rv9b_271">task-form.html</code> et <code class="code" id="-q5rv9b_272">task-list.html</code> restent identiques &agrave; celles de l'exercice 2)</span></p></div></div></section></section></section><section class="chapter"><h2 id="conclusion" data-toc="conclusion">Conclusion</h2><p id="-q5rv9b_273">Les messages flash sont un outil essentiel dans les applications web Spring MVC suivant le pattern PRG. Ils permettent de fournir un retour utilisateur clair et concis apr&egrave;s une action, en survivant de mani&egrave;re &eacute;l&eacute;gante &agrave; une redirection HTTP. Gr&acirc;ce &agrave; <code class="code" id="-q5rv9b_275">RedirectAttributes</code> et l'int&eacute;gration avec Thymeleaf, leur mise en &oelig;uvre est simple et directe. La factorisation via des m&eacute;thodes ou des composants utilitaires aide &agrave; maintenir un code propre et r&eacute;utilisable. En ma&icirc;trisant les messages flash, les d&eacute;veloppeurs peuvent am&eacute;liorer significativement l'exp&eacute;rience utilisateur de leurs applications web.</p></section><div class="last-modified">Last modified: 13 mai 2025</div><div data-feedback-placeholder="true"></div><div class="navigation-links _bottom"><a href="005-00-les-sessions.html" class="navigation-links__prev">Les sessions</a><a href="010-00-spring-data-jpa.html" class="navigation-links__next">Spring Data JPA</a></div></article><div id="disqus_thread"></div></div></section></main></div><script src="https://resources.jetbrains.com/writerside/apidoc/6.22.0-b725/app.js"></script></body></html>