<!DOCTYPE html SYSTEM "about:legacy-compat">
<html lang="en-US" data-preset="contrast" data-primary-color="#307FFF" data-resizable-sidebar="true"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="UTF-8"><meta name="robots" content="noindex"><meta name="built-on" content="2025-05-13T07:33:30.060451"><title>La gestion des exceptions | Spring</title><script type="application/json" id="virtual-toc-data">[{"id":"gestion-par-d-faut-de-spring-boot-la-whitelabel-error-page","level":0,"title":"Gestion par Défaut de Spring Boot : La \"Whitelabel Error Page\"","anchor":"#gestion-par-d-faut-de-spring-boot-la-whitelabel-error-page"},{"id":"pages-d-erreur-statiques-personnalis-es","level":0,"title":"Pages d\u0027Erreur Statiques Personnalisées","anchor":"#pages-d-erreur-statiques-personnalis-es"},{"id":"gestion-centralis-e-avec-controlleradvice-et-exceptionhandler","level":0,"title":"Gestion Centralisée avec @ControllerAdvice et @ExceptionHandler","anchor":"#gestion-centralis-e-avec-controlleradvice-et-exceptionhandler"},{"id":"mapper-les-exceptions-des-statuts-http-avec-responsestatus","level":0,"title":"Mapper les Exceptions à des Statuts HTTP avec @ResponseStatus","anchor":"#mapper-les-exceptions-des-statuts-http-avec-responsestatus"},{"id":"personnaliser-le-comportement-d-erreur-avec-errorcontroller","level":0,"title":"Personnaliser le Comportement d\u0027Erreur avec ErrorController","anchor":"#personnaliser-le-comportement-d-erreur-avec-errorcontroller"},{"id":"bonnes-pratiques-et-conseils","level":0,"title":"Bonnes Pratiques et Conseils","anchor":"#bonnes-pratiques-et-conseils"},{"id":"cas-d-utilisation-typiques","level":0,"title":"Cas d\u0027Utilisation Typiques","anchor":"#cas-d-utilisation-typiques"},{"id":"exercices-pratiques","level":0,"title":"Exercices Pratiques","anchor":"#exercices-pratiques"},{"id":"conclusion","level":0,"title":"Conclusion","anchor":"#conclusion"}]</script><script type="application/json" id="topic-shortcuts"></script><link href="https://resources.jetbrains.com/writerside/apidoc/6.22.0-b725/app.css" rel="stylesheet"><meta name="msapplication-TileColor" content="#000000"><link rel="apple-touch-icon" sizes="180x180" href="https://jetbrains.com/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="https://jetbrains.com/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="https://jetbrains.com/favicon-16x16.png"><meta name="msapplication-TileImage" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-144x144.png"><meta name="msapplication-square70x70logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-70x70.png"><meta name="msapplication-square150x150logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-150x150.png"><meta name="msapplication-wide310x150logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-310x150.png"><meta name="msapplication-square310x310logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-310x310.png"><meta name="image" content=""><!-- Open Graph --><meta property="og:title" content="La gestion des exceptions | Spring"><meta property="og:description" content=""><meta property="og:image" content=""><meta property="og:site_name" content="Spring Help"><meta property="og:type" content="website"><meta property="og:locale" content="en_US"><meta property="og:url" content="writerside-documentation/040-00-la-gestion-des-exceptions.html"><!-- End Open Graph --><!-- Twitter Card --><meta name="twitter:card" content="summary_large_image"><meta name="twitter:site" content=""><meta name="twitter:title" content="La gestion des exceptions | Spring"><meta name="twitter:description" content=""><meta name="twitter:creator" content=""><meta name="twitter:image:src" content=""><!-- End Twitter Card --><!-- Schema.org WebPage --><script type="application/ld+json">{
    "@context": "http://schema.org",
    "@type": "WebPage",
    "@id": "writerside-documentation/040-00-la-gestion-des-exceptions.html#webpage",
    "url": "writerside-documentation/040-00-la-gestion-des-exceptions.html",
    "name": "La gestion des exceptions | Spring",
    "description": "",
    "image": "",
    "inLanguage":"en-US"
}</script><!-- End Schema.org --><!-- Schema.org WebSite --><script type="application/ld+json">{
    "@type": "WebSite",
    "@id": "writerside-documentation/#website",
    "url": "writerside-documentation/",
    "name": "Spring Help"
}</script><!-- End Schema.org --></head><body data-id="040-00-La-gestion-des-exceptions" data-main-title="La gestion des exceptions" data-article-props="{&quot;seeAlsoStyle&quot;:&quot;links&quot;}" data-template="article" data-breadcrumbs=""><div class="wrapper"><main class="panel _main"><header class="panel__header"><div class="container"><h3>Spring  Help</h3><div class="panel-trigger"></div></div></header><section class="panel__content"><div class="container"><article class="article" data-shortcut-switcher="inactive"><h1 data-toc="040-00-La-gestion-des-exceptions" id="040-00-La-gestion-des-exceptions.md">La gestion des exceptions</h1><p id="-44yyd9_3"><span class="control" id="-44yyd9_17">Pourquoi G&eacute;rer les Exceptions ?</span></p><p id="-44yyd9_4">Dans toute application, des erreurs peuvent survenir : une ressource non trouv&eacute;e, une entr&eacute;e utilisateur invalide, un probl&egrave;me de base de donn&eacute;es, etc. Une gestion inad&eacute;quate des exceptions conduit &agrave; :</p><ul class="list _bullet" id="-44yyd9_5"><li class="list__item" id="-44yyd9_18"><p id="-44yyd9_21"><span class="control" id="-44yyd9_22">Mauvaise Exp&eacute;rience Utilisateur (UX) :</span> Des pages d'erreur techniques (comme les traces de pile Java) peuvent effrayer ou frustrer les utilisateurs.</p></li><li class="list__item" id="-44yyd9_19"><p id="-44yyd9_23"><span class="control" id="-44yyd9_24">Failles de S&eacute;curit&eacute; :</span> Les traces de pile peuvent exposer des d&eacute;tails internes de l'application (versions de librairies, structure du code, requ&ecirc;tes SQL) exploitables par des attaquants.</p></li><li class="list__item" id="-44yyd9_20"><p id="-44yyd9_25"><span class="control" id="-44yyd9_26">Manque d'Information :</span> Sans gestion appropri&eacute;e, il est difficile de diagnostiquer les probl&egrave;mes survenus en production.</p></li></ul><p id="-44yyd9_6">Spring Boot fournit plusieurs m&eacute;canismes pour intercepter et traiter ces erreurs de mani&egrave;re &eacute;l&eacute;gante et contr&ocirc;l&eacute;e dans le contexte d'une application web MVC.</p><section class="chapter"><h2 id="gestion-par-d-faut-de-spring-boot-la-whitelabel-error-page" data-toc="gestion-par-d-faut-de-spring-boot-la-whitelabel-error-page">Gestion par D&eacute;faut de Spring Boot : La &quot;Whitelabel Error Page&quot;</h2><p id="-44yyd9_27">Lorsqu'une exception non intercept&eacute;e se produit lors du traitement d'une requ&ecirc;te web (ou si une ressource n'est pas trouv&eacute;e - erreur 404), Spring Boot, par d&eacute;faut, redirige l'utilisateur vers une page d'erreur g&eacute;n&eacute;rique connue sous le nom de &quot;Whitelabel Error Page&quot;.</p><p id="-44yyd9_28">Cette page affiche des informations de base sur l'erreur (timestamp, statut HTTP, message d'erreur, chemin).</p><p id="-44yyd9_29"><span class="control" id="-44yyd9_34">Exemple de Sc&eacute;nario :</span> Supposons un contr&ocirc;leur simple :</p><div class="code-block" data-lang="java">
package fr.formation.spring.controller;

import org.springframework.stereotype.Controller;
import org.springframework.web.bind.annotation.GetMapping;

@Controller
public class DemoController {

    @GetMapping(&quot;/cause-error&quot;)
    public String causeError() {
        // Simule une erreur interne
        throw new RuntimeException(&quot;Something went wrong internally!&quot;);
    }

    @GetMapping(&quot;/hello&quot;)
    public String sayHello() {
        // Page qui fonctionne normalement
        return &quot;welcome&quot;; // Suppose une vue welcome.html
    }
}
</div><p id="-44yyd9_31">Si l'utilisateur acc&egrave;de &agrave; <code class="code" id="-44yyd9_35">/cause-error</code>, il verra la &quot;Whitelabel Error Page&quot; indiquant un statut 500 (Internal Server Error) et le message &quot;Something went wrong internally!&quot;. Si une URL inexistante est acc&eacute;d&eacute;e (ex: <code class="code" id="-44yyd9_36">/non-existent-page</code>), une Whitelabel Page avec un statut 404 (Not Found) sera affich&eacute;e.</p><p id="-44yyd9_32"><span class="control" id="-44yyd9_37">Limites :</span> La Whitelabel Error Page n'est pas destin&eacute;e &agrave; la production. Elle manque de personnalisation graphique et expose potentiellement trop d'informations techniques.</p></section><section class="chapter"><h2 id="pages-d-erreur-statiques-personnalis-es" data-toc="pages-d-erreur-statiques-personnalis-es">Pages d'Erreur Statiques Personnalis&eacute;es</h2><p id="-44yyd9_38">La mani&egrave;re la plus simple de remplacer la Whitelabel Error Page est de fournir des fichiers HTML statiques nomm&eacute;s selon le code de statut HTTP.</p><p id="-44yyd9_39"><span class="control" id="-44yyd9_50">Fonctionnement :</span> Spring Boot recherche des fichiers dans des emplacements sp&eacute;cifiques du classpath :</p><ul class="list _bullet" id="-44yyd9_40"><li class="list__item" id="-44yyd9_51"><p id="-44yyd9_55"><code class="code" id="-44yyd9_56">/static/error/&lt;code&gt;.html</code></p></li><li class="list__item" id="-44yyd9_52"><p id="-44yyd9_57"><code class="code" id="-44yyd9_58">/public/error/&lt;code&gt;.html</code></p></li><li class="list__item" id="-44yyd9_53"><p id="-44yyd9_59"><code class="code" id="-44yyd9_60">/resources/error/&lt;code&gt;.html</code></p></li><li class="list__item" id="-44yyd9_54"><p id="-44yyd9_61"><code class="code" id="-44yyd9_62">/templates/error/&lt;code&gt;.html</code> (si Thymeleaf ou un autre moteur de template est utilis&eacute; et configur&eacute; pour cet emplacement)</p></li></ul><p id="-44yyd9_41">O&ugrave; <code class="code" id="-44yyd9_63">&lt;code&gt;</code> est le code de statut HTTP (ex: <code class="code" id="-44yyd9_64">404</code>, <code class="code" id="-44yyd9_65">500</code>).</p><p id="-44yyd9_42"><span class="control" id="-44yyd9_66">Exemple : Cr&eacute;er une page 404 personnalis&eacute;e</span></p><ol class="list _decimal" id="-44yyd9_43" type="1"><li class="list__item" id="-44yyd9_67"><p id="-44yyd9_69">Cr&eacute;ez le r&eacute;pertoire <code class="code" id="-44yyd9_70">src/main/resources/templates/error/</code> (si vous utilisez Thymeleaf dans <code class="code" id="-44yyd9_71">src/main/resources/templates/</code>).</p></li><li class="list__item" id="-44yyd9_68"><p id="-44yyd9_72">Cr&eacute;ez un fichier <code class="code" id="-44yyd9_73">404.html</code> dans ce r&eacute;pertoire :</p></li></ol><div class="code-block" data-lang="markup">
&lt;!DOCTYPE html&gt;
&lt;html xmlns:th=&quot;http://www.thymeleaf.org&quot;&gt;
&lt;head&gt;
    &lt;meta charset=&quot;UTF-8&quot;&gt;
    &lt;title&gt;Page Non Trouvée&lt;/title&gt;
    &lt;link rel=&quot;stylesheet&quot; th:href=&quot;@{/css/style.css}&quot;/&gt; &lt;!-- Optionnel --&gt;
&lt;/head&gt;
&lt;body&gt;
&lt;h1&gt;Oops! Page Non Trouvée (Erreur 404)&lt;/h1&gt;
&lt;p&gt;
    Désolé, la page que vous cherchez n'existe pas ou a été déplacée.
&lt;/p&gt;
&lt;p&gt;
    &lt;a th:href=&quot;@{/}&quot;&gt;Retour à l'accueil&lt;/a&gt;
&lt;/p&gt;
&lt;/body&gt;
&lt;/html&gt;
</div><ol class="list _decimal" id="-44yyd9_45" type="1" start="3"><li class="list__item" id="-44yyd9_74"><p id="-44yyd9_75">Cr&eacute;ez de m&ecirc;me un fichier <code class="code" id="-44yyd9_76">500.html</code> pour les erreurs serveur internes.</p></li></ol><div class="code-block" data-lang="markup">
&lt;!DOCTYPE html&gt;
&lt;html xmlns:th=&quot;http://www.thymeleaf.org&quot;&gt;
&lt;head&gt;
    &lt;meta charset=&quot;UTF-8&quot;&gt;
    &lt;title&gt;Erreur Interne&lt;/title&gt;
    &lt;link rel=&quot;stylesheet&quot; th:href=&quot;@{/css/style.css}&quot;/&gt; &lt;!-- Optionnel --&gt;
&lt;/head&gt;
&lt;body&gt;
&lt;h1&gt;Oops! Une erreur s'est produite (Erreur 500)&lt;/h1&gt;
&lt;p&gt;
    Nous rencontrons des difficultés techniques.
    Veuillez réessayer plus tard.
&lt;/p&gt;
&lt;p&gt;
    &lt;a th:href=&quot;@{/}&quot;&gt;Retour à l'accueil&lt;/a&gt;
&lt;/p&gt;
&lt;/body&gt;
&lt;/html&gt;
</div><p id="-44yyd9_47">Maintenant, en cas d'erreur 404 ou 500, Spring Boot affichera ces pages personnalis&eacute;es au lieu de la Whitelabel Page.</p><p id="-44yyd9_48"><span class="control" id="-44yyd9_77">Avantages :</span> Simple &agrave; mettre en &oelig;uvre pour les erreurs HTTP courantes. <span class="control" id="-44yyd9_78">Inconv&eacute;nients :</span> Statique. Ne permet pas d'afficher des informations dynamiques sur l'erreur (sauf si on utilise <code class="code" id="-44yyd9_79">ErrorController</code>, voir section 6) ni de g&eacute;rer des exceptions Java sp&eacute;cifiques de mani&egrave;re diff&eacute;renci&eacute;e.</p></section><section class="chapter"><h2 id="gestion-centralis-e-avec-controlleradvice-et-exceptionhandler" data-toc="gestion-centralis-e-avec-controlleradvice-et-exceptionhandler">Gestion Centralis&eacute;e avec <code class="code" id="-44yyd9_107">@ControllerAdvice</code> et <code class="code" id="-44yyd9_108">@ExceptionHandler</code></h2><p id="-44yyd9_81">Pour une gestion plus fine et centralis&eacute;e des exceptions applicatives, Spring AOP (utilis&eacute; par Spring Boot) offre les annotations <code class="code" id="-44yyd9_109">@ControllerAdvice</code> et <code class="code" id="-44yyd9_110">@ExceptionHandler</code>.</p><ul class="list _bullet" id="-44yyd9_82"><li class="list__item" id="-44yyd9_111"><p id="-44yyd9_113"><code class="code" id="-44yyd9_114">@ControllerAdvice</code>: Annotation de classe. Permet de regrouper des configurations globales (<code class="code" id="-44yyd9_115">@ExceptionHandler</code>, <code class="code" id="-44yyd9_116">@InitBinder</code>, <code class="code" id="-44yyd9_117">@ModelAttribute</code>) qui s'appliquent &agrave; plusieurs (ou tous les) contr&ocirc;leurs.</p></li><li class="list__item" id="-44yyd9_112"><p id="-44yyd9_118"><code class="code" id="-44yyd9_119">@ExceptionHandler</code>: Annotation de m&eacute;thode. Au sein d'une classe <code class="code" id="-44yyd9_120">@Controller</code> ou <code class="code" id="-44yyd9_121">@ControllerAdvice</code>, cette annotation d&eacute;clare une m&eacute;thode qui g&eacute;rera les exceptions d'un type sp&eacute;cifique (ou de ses sous-types).</p></li></ul><p id="-44yyd9_83"><span class="control" id="-44yyd9_122">Fonctionnement :</span> Lorsqu'une exception est lev&eacute;e par une m&eacute;thode d'un contr&ocirc;leur, Spring recherche :</p><ol class="list _decimal" id="-44yyd9_84" type="1"><li class="list__item" id="-44yyd9_123"><p id="-44yyd9_126">Une m&eacute;thode <code class="code" id="-44yyd9_127">@ExceptionHandler</code> au sein du contr&ocirc;leur lui-m&ecirc;me capable de g&eacute;rer ce type d'exception.</p></li><li class="list__item" id="-44yyd9_124"><p id="-44yyd9_128">Si non trouv&eacute;e, il cherche une m&eacute;thode <code class="code" id="-44yyd9_129">@ExceptionHandler</code> dans une classe <code class="code" id="-44yyd9_130">@ControllerAdvice</code> capable de g&eacute;rer ce type d'exception.</p></li><li class="list__item" id="-44yyd9_125"><p id="-44yyd9_131">Si toujours non trouv&eacute;e, l'exception remonte jusqu'au conteneur de servlets, qui d&eacute;clenche le m&eacute;canisme d'erreur standard (menant potentiellement aux pages d'erreur statiques ou &agrave; la Whitelabel Page).</p></li></ol><p id="-44yyd9_85"><span class="control" id="-44yyd9_132">Exemple : G&eacute;rer une exception m&eacute;tier sp&eacute;cifique</span></p><ol class="list _decimal" id="-44yyd9_86" type="1"><li class="list__item" id="-44yyd9_133"><p id="-44yyd9_134"><span class="control" id="-44yyd9_135">Cr&eacute;er une exception personnalis&eacute;e :</span></p></li></ol><div class="code-block" data-lang="java">
package fr.formation.spring.exception;

// Exception spécifique si un produit demandé n'est pas trouvé
public class ProductNotFoundException extends RuntimeException {
    private final Long productId;

    public ProductNotFoundException(Long productId) {
        // Message d'erreur générique
        super(&quot;Product not found with ID: &quot; + productId);
        this.productId = productId;
    }

    public Long getProductId() {
        return productId;
    }
}
</div><ol class="list _decimal" id="-44yyd9_88" type="1" start="2"><li class="list__item" id="-44yyd9_136"><p id="-44yyd9_137"><span class="control" id="-44yyd9_138">Lever l'exception dans un contr&ocirc;leur :</span></p></li></ol><div class="code-block" data-lang="java">
package fr.formation.spring.controller;

import fr.formation.spring.exception.ProductNotFoundException;
import org.springframework.stereotype.Controller;
import org.springframework.ui.Model;
import org.springframework.web.bind.annotation.GetMapping;
import org.springframework.web.bind.annotation.PathVariable;
import org.springframework.web.bind.annotation.RequestMapping;

@Controller
@RequestMapping(&quot;/products&quot;)
public class ProductController {

    // Simule la récupération d'un produit
    @GetMapping(&quot;/{id}&quot;)
    public String getProductById(@PathVariable Long id, Model model) {
        if (id == 0) { // Simule un produit non trouvé
            throw new ProductNotFoundException(id);
        }
        // Logique pour récupérer le produit et l'ajouter au modèle
        model.addAttribute(&quot;productName&quot;, &quot;Awesome Product &quot; + id);
        return &quot;product-details&quot;; // Vue product-details.html
    }
}
</div><ol class="list _decimal" id="-44yyd9_90" type="1" start="3"><li class="list__item" id="-44yyd9_139"><p id="-44yyd9_140"><span class="control" id="-44yyd9_141">Cr&eacute;er le gestionnaire d'exceptions global (<code class="code" id="-44yyd9_142">@ControllerAdvice</code>) :</span></p></li></ol><div class="code-block" data-lang="java">
package fr.formation.spring.advice;

import fr.formation.spring.exception.ProductNotFoundException;
import org.slf4j.Logger;
import org.slf4j.LoggerFactory;
import org.springframework.web.bind.annotation.ControllerAdvice;
import org.springframework.web.bind.annotation.ExceptionHandler;
import org.springframework.web.servlet.ModelAndView; // Important pour retourner une vue

import jakarta.servlet.http.HttpServletRequest; // Pour obtenir des infos requête

@ControllerAdvice // S'applique à tous les contrôleurs
public class GlobalExceptionHandler {

    private static final Logger log =
            LoggerFactory.getLogger(GlobalExceptionHandler.class);

    // Gère spécifiquement ProductNotFoundException
    @ExceptionHandler(ProductNotFoundException.class)
    public ModelAndView handleProductNotFound(
            HttpServletRequest request, // Info sur la requête originale
            ProductNotFoundException ex) { // L'exception capturée

        log.error(&quot;ProductNotFoundException occurred for ID {}: Request: {}&quot;,
                ex.getProductId(), request.getRequestURI(), ex);

        // Prépare le modèle et la vue à retourner
        ModelAndView modelAndView = new ModelAndView();
        // Ajoute des attributs pour la vue
        modelAndView.addObject(&quot;errorMessage&quot;, ex.getMessage());
        modelAndView.addObject(&quot;requestedId&quot;, ex.getProductId());
        modelAndView.addObject(&quot;requestedUrl&quot;, request.getRequestURL());

        // Définit la vue à afficher (ex: error/product-not-found.html)
        modelAndView.setViewName(&quot;error/product-not-found&quot;);

        return modelAndView;
    }

    // Gestionnaire générique pour d'autres exceptions (facultatif mais recommandé)
    @ExceptionHandler(Exception.class)
    public ModelAndView handleGenericException(
            HttpServletRequest request,
            Exception ex) {

        log.error(&quot;Unhandled exception occurred: Request: {}&quot;,
                request.getRequestURI(), ex);

        ModelAndView modelAndView = new ModelAndView();
        modelAndView.addObject(&quot;errorMessage&quot;,
                &quot;An unexpected error occurred. Please try again later.&quot;);
        modelAndView.addObject(&quot;requestedUrl&quot;, request.getRequestURL());
        // Vue générique (ex: error/generic-error.html ou la 500.html)
        modelAndView.setViewName(&quot;error/generic-error&quot;);

        return modelAndView;
    }
}
</div><p id="-44yyd9_92"><span class="emphasis" id="-44yyd9_143">Note sur l'indentation et la limite de 80 caract&egrave;res :</span> Le code ci-dessus respecte cette limite. Les logs peuvent n&eacute;cessiter des sauts de ligne pour les messages longs.</p><ol class="list _decimal" id="-44yyd9_93" type="1" start="4"><li class="list__item" id="-44yyd9_144"><p id="-44yyd9_145"><span class="control" id="-44yyd9_146">Cr&eacute;er la vue d'erreur sp&eacute;cifique (<code class="code" id="-44yyd9_147">src/main/resources/templates/error/product-not-found.html</code>) :</span></p></li></ol><div class="code-block" data-lang="markup">
&lt;!DOCTYPE html&gt;
&lt;html xmlns:th=&quot;http://www.thymeleaf.org&quot;&gt;
&lt;head&gt;
    &lt;meta charset=&quot;UTF-8&quot;&gt;
    &lt;title&gt;Produit Non Trouvé&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
&lt;h1&gt;Produit Non Trouvé&lt;/h1&gt;
&lt;p th:text=&quot;${errorMessage}&quot;&gt;Message d'erreur par défaut&lt;/p&gt;
&lt;p&gt;
    L'identifiant demandé était :
    &lt;strong th:text=&quot;${requestedId}&quot;&gt;ID inconnu&lt;/strong&gt;
&lt;/p&gt;
&lt;p&gt;URL demandée : &lt;span th:text=&quot;${requestedUrl}&quot;&gt;URL&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;a th:href=&quot;@{/}&quot;&gt;Retour à l'accueil&lt;/a&gt;&lt;/p&gt;
&lt;/body&gt;
&lt;/html&gt;
</div><ol class="list _decimal" id="-44yyd9_95" type="1" start="5"><li class="list__item" id="-44yyd9_148"><p id="-44yyd9_149"><span class="control" id="-44yyd9_150">Cr&eacute;er la vue d'erreur g&eacute;n&eacute;rique (<code class="code" id="-44yyd9_151">src/main/resources/templates/error/generic-error.html</code>) :</span></p></li></ol><div class="code-block" data-lang="markup">
&lt;!DOCTYPE html&gt;
&lt;html xmlns:th=&quot;http://www.thymeleaf.org&quot;&gt;
&lt;head&gt;
    &lt;meta charset=&quot;UTF-8&quot;&gt;
    &lt;title&gt;Erreur Inattendue&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
&lt;h1&gt;Une Erreur s'est Produite&lt;/h1&gt;
&lt;p th:text=&quot;${errorMessage}&quot;&gt;Message d'erreur par défaut&lt;/p&gt;
&lt;p&gt;URL demandée : &lt;span th:text=&quot;${requestedUrl}&quot;&gt;URL&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;a th:href=&quot;@{/}&quot;&gt;Retour à l'accueil&lt;/a&gt;&lt;/p&gt;
&lt;/body&gt;
&lt;/html&gt;
</div><p id="-44yyd9_97"><span class="control" id="-44yyd9_152">Fonctionnement d&eacute;taill&eacute; :</span> Si l'URL <code class="code" id="-44yyd9_153">/products/0</code> est acc&eacute;d&eacute;e :</p><ol class="list _decimal" id="-44yyd9_98" type="1"><li class="list__item" id="-44yyd9_154"><p id="-44yyd9_159"><code class="code" id="-44yyd9_160">ProductController.getProductById</code> l&egrave;ve <code class="code" id="-44yyd9_161">ProductNotFoundException</code>.</p></li><li class="list__item" id="-44yyd9_155"><p id="-44yyd9_162">Spring intercepte l'exception.</p></li><li class="list__item" id="-44yyd9_156"><p id="-44yyd9_163">Il trouve <code class="code" id="-44yyd9_164">GlobalExceptionHandler.handleProductNotFound</code> via <code class="code" id="-44yyd9_165">@ControllerAdvice</code> et <code class="code" id="-44yyd9_166">@ExceptionHandler(ProductNotFoundException.class)</code>.</p></li><li class="list__item" id="-44yyd9_157"><p id="-44yyd9_167">Cette m&eacute;thode est ex&eacute;cut&eacute;e. Elle logue l'erreur, cr&eacute;e un <code class="code" id="-44yyd9_168">ModelAndView</code>, y ajoute des donn&eacute;es (message, ID, URL), et sp&eacute;cifie la vue <code class="code" id="-44yyd9_169">error/product-not-found</code>.</p></li><li class="list__item" id="-44yyd9_158"><p id="-44yyd9_170">Spring Boot rend la vue <code class="code" id="-44yyd9_171">error/product-not-found.html</code> en utilisant les donn&eacute;es du mod&egrave;le.</p></li></ol><p id="-44yyd9_99"><span class="control" id="-44yyd9_172">Gestion de plusieurs exceptions :</span> Une m&eacute;thode <code class="code" id="-44yyd9_173">@ExceptionHandler</code> peut g&eacute;rer plusieurs types d'exceptions :</p><div class="code-block" data-lang="java">

@ExceptionHandler({OrderNotFoundException.class, InvoiceNotFoundException.class})
public ModelAndView handleResourceNotFound(HttpServletRequest request, Exception ex) {
    // ... logique commune pour ces exceptions ...
    ModelAndView mav = new ModelAndView();
    mav.addObject(&quot;errorMessage&quot;, &quot;The requested resource was not found.&quot;);
    mav.addObject(&quot;details&quot;, ex.getMessage()); // Message spécifique de l'exception
    mav.setViewName(&quot;error/resource-not-found&quot;); // Vue générique pour &quot;non trouvé&quot;
    return mav;
}
</div><p id="-44yyd9_101"><span class="control" id="-44yyd9_174">Ordre de priorit&eacute; :</span> Spring choisit le gestionnaire le plus sp&eacute;cifique. Un <code class="code" id="-44yyd9_175">@ExceptionHandler(Exception.class)</code> est un gestionnaire &quot;fourre-tout&quot; qui ne sera appel&eacute; que si aucun gestionnaire plus pr&eacute;cis n'est trouv&eacute;.</p><p id="-44yyd9_102"><span class="control" id="-44yyd9_176">Avantages :</span></p><ul class="list _bullet" id="-44yyd9_103"><li class="list__item" id="-44yyd9_177"><p id="-44yyd9_180">Gestion centralis&eacute;e et r&eacute;utilisable du code de gestion d'erreur.</p></li><li class="list__item" id="-44yyd9_178"><p id="-44yyd9_181">Possibilit&eacute; de retourner des vues sp&eacute;cifiques avec des donn&eacute;es dynamiques.</p></li><li class="list__item" id="-44yyd9_179"><p id="-44yyd9_182">Contr&ocirc;le fin sur la logique de gestion (log, notification, etc.).</p></li></ul><p id="-44yyd9_104"><span class="control" id="-44yyd9_183">Inconv&eacute;nients :</span></p><ul class="list _bullet" id="-44yyd9_105"><li class="list__item" id="-44yyd9_184"><p id="-44yyd9_185">Ne g&egrave;re pas nativement les erreurs qui surviennent <span class="emphasis" id="-44yyd9_186">avant</span> d'atteindre un contr&ocirc;leur (ex: erreur 404 pour une URL non mapp&eacute;e, erreur 400 pour une conversion de type &eacute;chou&eacute;e sur un param&egrave;tre de m&eacute;thode avant l'appel de la m&eacute;thode elle-m&ecirc;me). Ces erreurs sont g&eacute;n&eacute;ralement g&eacute;r&eacute;es par le m&eacute;canisme d' <code class="code" id="-44yyd9_187">ErrorController</code> ou les pages statiques.</p></li></ul></section><section class="chapter"><h2 id="mapper-les-exceptions-des-statuts-http-avec-responsestatus" data-toc="mapper-les-exceptions-des-statuts-http-avec-responsestatus">Mapper les Exceptions &agrave; des Statuts HTTP avec <code class="code" id="-44yyd9_198">@ResponseStatus</code></h2><p id="-44yyd9_189">L'annotation <code class="code" id="-44yyd9_199">@ResponseStatus</code> peut &ecirc;tre plac&eacute;e directement sur une classe d'exception personnalis&eacute;e ou sur une m&eacute;thode <code class="code" id="-44yyd9_200">@ExceptionHandler</code>.</p><ul class="list _bullet" id="-44yyd9_190"><li class="list__item" id="-44yyd9_201"><p id="-44yyd9_202"><span class="control" id="-44yyd9_203">Sur une classe d'exception :</span> Indique le statut HTTP &agrave; retourner par d&eacute;faut lorsque cette exception n'est pas g&eacute;r&eacute;e par un <code class="code" id="-44yyd9_204">@ExceptionHandler</code> sp&eacute;cifique qui d&eacute;finirait lui-m&ecirc;me un statut ou une vue.</p></li></ul><div class="code-block" data-lang="java">
package fr.formation.spring.exception;

import org.springframework.http.HttpStatus;
import org.springframework.web.bind.annotation.ResponseStatus;

// Associe cette exception au statut HTTP 404 Not Found
@ResponseStatus(value = HttpStatus.NOT_FOUND, reason = &quot;Requested product does not exist&quot;)
public class ProductNotFoundException extends RuntimeException {
    // ... constructeur et méthodes ...
    public ProductNotFoundException(Long productId) {
        super(&quot;Product not found with ID: &quot; + productId);
        // ...
    }
}
</div><p id="-44yyd9_192">Si cette exception est lev&eacute;e et <span class="emphasis" id="-44yyd9_205">non</span> intercept&eacute;e par un <code class="code" id="-44yyd9_206">@ExceptionHandler</code>, Spring utilisera le statut <code class="code" id="-44yyd9_207">404</code> et la <code class="code" id="-44yyd9_208">reason</code> (si fournie). Le corps de la r&eacute;ponse d&eacute;pendra alors des autres m&eacute;canismes (page <code class="code" id="-44yyd9_209">404.html</code>, <code class="code" id="-44yyd9_210">ErrorController</code>, Whitelabel Page).</p><ul class="list _bullet" id="-44yyd9_193"><li class="list__item" id="-44yyd9_211"><p id="-44yyd9_212"><span class="control" id="-44yyd9_213">Sur une m&eacute;thode <code class="code" id="-44yyd9_215">@ExceptionHandler</code>:</span> Permet de forcer un statut HTTP sp&eacute;cifique pour la r&eacute;ponse, m&ecirc;me si la m&eacute;thode retourne un <code class="code" id="-44yyd9_214">ModelAndView</code>.</p></li></ul><div class="code-block" data-lang="java">

@ControllerAdvice
public class GlobalExceptionHandler {

    // ... autres handlers ...

    @ExceptionHandler(IllegalArgumentException.class)
    @ResponseStatus(HttpStatus.BAD_REQUEST) // Force un statut 400
    public ModelAndView handleIllegalArgument(
            HttpServletRequest request,
            IllegalArgumentException ex) {

        log.warn(&quot;Bad request received: {} - Request: {}&quot;,
                ex.getMessage(), request.getRequestURI());

        ModelAndView modelAndView = new ModelAndView();
        modelAndView.addObject(&quot;errorMessage&quot;, &quot;Invalid input: &quot; + ex.getMessage());
        modelAndView.setViewName(&quot;error/bad-request&quot;); // Vue spécifique pour 400
        return modelAndView;
    }
}
</div><p id="-44yyd9_195">Ici, m&ecirc;me si on retourne une vue (<code class="code" id="-44yyd9_216">error/bad-request</code>), la r&eacute;ponse HTTP aura bien le statut 400. Sans <code class="code" id="-44yyd9_217">@ResponseStatus</code> ici, le statut serait par d&eacute;faut 200 (OK) car on retourne une vue avec succ&egrave;s.</p><p id="-44yyd9_196"><span class="control" id="-44yyd9_218">Utilisation conjointe :</span> On peut avoir <code class="code" id="-44yyd9_219">@ResponseStatus</code> sur l'exception ET un <code class="code" id="-44yyd9_220">@ExceptionHandler</code>. L'annotation sur le handler a priorit&eacute; si elle est pr&eacute;sente.</p></section><section class="chapter"><h2 id="personnaliser-le-comportement-d-erreur-avec-errorcontroller" data-toc="personnaliser-le-comportement-d-erreur-avec-errorcontroller">Personnaliser le Comportement d'Erreur avec <code class="code" id="-44yyd9_238">ErrorController</code></h2><p id="-44yyd9_222">Pour un contr&ocirc;le ultime sur le rendu de <span class="emphasis" id="-44yyd9_239">toutes</span> les erreurs qui aboutissent au chemin <code class="code" id="-44yyd9_240">/error</code> (y compris les 404 non mapp&eacute;es, les erreurs de conteneur, et les exceptions non g&eacute;r&eacute;es par <code class="code" id="-44yyd9_241">@ExceptionHandler</code> qui provoquent une redirection vers <code class="code" id="-44yyd9_242">/error</code>), on peut impl&eacute;menter l'interface <code class="code" id="-44yyd9_243">ErrorController</code> de Spring Boot.</p><p id="-44yyd9_223">Spring Boot fournit une impl&eacute;mentation par d&eacute;faut : <code class="code" id="-44yyd9_244">BasicErrorController</code>. C'est elle qui g&egrave;re l'affichage de la Whitelabel Error Page ou le rendu des vues <code class="code" id="-44yyd9_245">error/&lt;code&gt;.html</code> si elles existent (en passant quelques attributs d'erreur de base).</p><p id="-44yyd9_224"><span class="control" id="-44yyd9_246">Pourquoi personnaliser <code class="code" id="-44yyd9_247">ErrorController</code>?</span></p><ul class="list _bullet" id="-44yyd9_225"><li class="list__item" id="-44yyd9_248"><p id="-44yyd9_251">Pour utiliser une logique complexe afin de d&eacute;terminer quelle vue afficher.</p></li><li class="list__item" id="-44yyd9_249"><p id="-44yyd9_252">Pour ajouter des attributs personnalis&eacute;s au mod&egrave;le de la page d'erreur, bas&eacute;s sur les d&eacute;tails de l'erreur r&eacute;cup&eacute;r&eacute;s via <code class="code" id="-44yyd9_253">ErrorAttributes</code>.</p></li><li class="list__item" id="-44yyd9_250"><p id="-44yyd9_254">Pour avoir un point central de gestion des erreurs HTTP g&eacute;n&eacute;riques (4xx, 5xx) qui ne correspondent pas &agrave; des exceptions applicatives sp&eacute;cifiques.</p></li></ul><p id="-44yyd9_226"><span class="control" id="-44yyd9_255">Exemple : Cr&eacute;er un <code class="code" id="-44yyd9_256">CustomErrorController</code></span></p><ol class="list _decimal" id="-44yyd9_227" type="1"><li class="list__item" id="-44yyd9_257"><p id="-44yyd9_258"><span class="control" id="-44yyd9_259">Impl&eacute;menter <code class="code" id="-44yyd9_260">ErrorController</code>:</span></p></li></ol><div class="code-block" data-lang="java">
package fr.formation.spring.controller;

import org.springframework.boot.web.servlet.error.ErrorController;
import org.springframework.stereotype.Controller;
import org.springframework.ui.Model;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.boot.web.error.ErrorAttributeOptions;
import org.springframework.boot.web.servlet.error.ErrorAttributes;
import org.springframework.web.context.request.ServletWebRequest;
import org.springframework.http.HttpStatus;

import jakarta.servlet.RequestDispatcher;
import jakarta.servlet.http.HttpServletRequest;

import java.util.Map;

@Controller
public class CustomErrorController implements ErrorController {

    private final ErrorAttributes errorAttributes;

    // Injecte ErrorAttributes pour obtenir les détails de l'erreur
    public CustomErrorController(ErrorAttributes errorAttributes) {
        this.errorAttributes = errorAttributes;
    }

    // Mappe les requêtes vers /error
    @RequestMapping(&quot;/error&quot;)
    public String handleError(HttpServletRequest request, Model model) {
        // Récupère les attributs d'erreur standards
        ServletWebRequest webRequest = new ServletWebRequest(request);
        Map&lt;String, Object&gt; errorDetails = this.errorAttributes.getErrorAttributes(
                webRequest,
                ErrorAttributeOptions.of( // Options pour inclure plus de détails
                        ErrorAttributeOptions.Include.MESSAGE,
                        ErrorAttributeOptions.Include.EXCEPTION, // Attention en prod !
                        ErrorAttributeOptions.Include.STACK_TRACE // Attention en prod !
                )
        );

        // Récupère le statut HTTP de l'erreur
        Object status = request.getAttribute(RequestDispatcher.ERROR_STATUS_CODE);
        int statusCode = HttpStatus.INTERNAL_SERVER_ERROR.value(); // Défaut 500
        if (status != null) {
            statusCode = Integer.parseInt(status.toString());
        }

        // Ajoute les détails au modèle pour la vue
        model.addAttribute(&quot;statusCode&quot;, statusCode);
        model.addAttribute(&quot;timestamp&quot;, errorDetails.get(&quot;timestamp&quot;));
        model.addAttribute(&quot;errorMessage&quot;, errorDetails.get(&quot;message&quot;));
        model.addAttribute(&quot;errorDetails&quot;, errorDetails.get(&quot;error&quot;)); // Type d'erreur
        model.addAttribute(&quot;path&quot;, errorDetails.get(&quot;path&quot;));
        // N'exposez JAMAIS la trace complète en production !
        // model.addAttribute(&quot;trace&quot;, errorDetails.get(&quot;trace&quot;));

        // Logique pour choisir la vue en fonction du statut
        if (statusCode == HttpStatus.NOT_FOUND.value()) {
            // Utilise la vue 404.html (ou une autre vue spécifique)
            return &quot;error/404&quot;; // Assurez-vous que templates/error/404.html existe
        } else if (statusCode == HttpStatus.FORBIDDEN.value()) {
            // Utilise la vue 403.html
            return &quot;error/403&quot;;
        }
        // Pour toutes les autres erreurs (500, etc.)
        // Utilise la vue 500.html ou une vue générique
        return &quot;error/generic-error&quot;; // Assurez-vous qu'elle existe
    }

    // getErrorPath() est déprécié, l'annotation @RequestMapping(&quot;/error&quot;) suffit
    // @Override
    // public String getErrorPath() {
    //     return &quot;/error&quot;;
    // }
}
</div><p id="-44yyd9_229"><span class="emphasis" id="-44yyd9_261">Note :</span> <code class="code" id="-44yyd9_262">ErrorAttributes</code> permet d'acc&eacute;der aux informations d'erreur collect&eacute;es par Spring Boot. <code class="code" id="-44yyd9_263">ErrorAttributeOptions</code> contr&ocirc;le le niveau de d&eacute;tail inclus. Soyez prudent avec <code class="code" id="-44yyd9_264">EXCEPTION</code> et <code class="code" id="-44yyd9_265">STACK_TRACE</code> en production.</p><ol class="list _decimal" id="-44yyd9_230" type="1" start="2"><li class="list__item" id="-44yyd9_266"><p id="-44yyd9_267"><span class="control" id="-44yyd9_268">Cr&eacute;er les vues correspondantes</span> (ex: <code class="code" id="-44yyd9_269">error/404.html</code>, <code class="code" id="-44yyd9_270">error/403.html</code>, <code class="code" id="-44yyd9_271">error/generic-error.html</code> dans <code class="code" id="-44yyd9_272">src/main/resources/templates/</code>) et utiliser les attributs pass&eacute;s via le <code class="code" id="-44yyd9_273">Model</code>.</p></li></ol><p id="-44yyd9_231">Exemple <code class="code" id="-44yyd9_274">error/generic-error.html</code> utilisant les attributs :</p><div class="code-block" data-lang="markup">
&lt;!DOCTYPE html&gt;
&lt;html xmlns:th=&quot;http://www.thymeleaf.org&quot;&gt;
&lt;head&gt;
    &lt;meta charset=&quot;UTF-8&quot;&gt;
    &lt;title&gt;Erreur&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
&lt;h1 th:text=&quot;'Erreur ' + ${statusCode} + ' : ' + ${errorDetails}&quot;&gt;
    Erreur Générique
&lt;/h1&gt;
&lt;p&gt;Timestamp: &lt;span th:text=&quot;${timestamp}&quot;&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;Chemin: &lt;span th:text=&quot;${path}&quot;&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;Message: &lt;span th:text=&quot;${errorMessage}&quot;&gt;&lt;/span&gt;&lt;/p&gt;
&lt;!-- Ne pas afficher la trace en production --&gt;
&lt;!-- &lt;pre th:text=&quot;${trace}&quot;&gt;&lt;/pre&gt; --&gt;
&lt;p&gt;&lt;a th:href=&quot;@{/}&quot;&gt;Retour à l'accueil&lt;/a&gt;&lt;/p&gt;
&lt;/body&gt;
&lt;/html&gt;
</div><p id="-44yyd9_233"><span class="control" id="-44yyd9_275">Avantages :</span></p><ul class="list _bullet" id="-44yyd9_234"><li class="list__item" id="-44yyd9_276"><p id="-44yyd9_279">Contr&ocirc;le total sur le rendu de toutes les erreurs redirig&eacute;es vers <code class="code" id="-44yyd9_280">/error</code>.</p></li><li class="list__item" id="-44yyd9_277"><p id="-44yyd9_281">Point unique pour g&eacute;rer les erreurs HTTP standards (4xx, 5xx) de mani&egrave;re coh&eacute;rente.</p></li><li class="list__item" id="-44yyd9_278"><p id="-44yyd9_282">Permet d'enrichir les pages d'erreur avec des informations dynamiques d&eacute;taill&eacute;es.</p></li></ul><p id="-44yyd9_235"><span class="control" id="-44yyd9_283">Inconv&eacute;nients :</span></p><ul class="list _bullet" id="-44yyd9_236"><li class="list__item" id="-44yyd9_284"><p id="-44yyd9_286">Plus complexe &agrave; mettre en place que les pages statiques ou les <code class="code" id="-44yyd9_287">@ExceptionHandler</code> simples.</p></li><li class="list__item" id="-44yyd9_285"><p id="-44yyd9_288"><code class="code" id="-44yyd9_289">BasicErrorController</code> fait d&eacute;j&agrave; beaucoup, la personnalisation n'est n&eacute;cessaire que pour des besoins avanc&eacute;s.</p></li></ul></section><section class="chapter"><h2 id="bonnes-pratiques-et-conseils" data-toc="bonnes-pratiques-et-conseils">Bonnes Pratiques et Conseils</h2><ol class="list _decimal" id="-44yyd9_290" type="1"><li class="list__item" id="-44yyd9_292"><p id="-44yyd9_301"><span class="control" id="-44yyd9_302">Loggez Syst&eacute;matiquement les Exceptions :</span> Utilisez un framework de logging (Logback - par d&eacute;faut dans Spring Boot, Log4j2, etc.) pour enregistrer les d&eacute;tails complets des exceptions (y compris la trace de pile) c&ocirc;t&eacute; serveur. C'est crucial pour le d&eacute;bogage. Les <code class="code" id="-44yyd9_303">@ExceptionHandler</code> et <code class="code" id="-44yyd9_304">ErrorController</code> sont de bons endroits pour loguer.</p></li><li class="list__item" id="-44yyd9_293"><p id="-44yyd9_305"><span class="control" id="-44yyd9_306">Ne Pas Exposer les D&eacute;tails Techniques aux Utilisateurs :</span> Affichez des messages d'erreur clairs, conviviaux et non techniques. Ne montrez jamais de traces de pile ou de messages d'erreur bruts de la base de donn&eacute;es sur la page rendue.</p></li><li class="list__item" id="-44yyd9_294"><p id="-44yyd9_307"><span class="control" id="-44yyd9_308">Utilisez des Pages d'Erreur Personnalis&eacute;es :</span> Remplacez toujours la Whitelabel Error Page en production par des pages qui correspondent &agrave; l'identit&eacute; visuelle de votre application.</p></li><li class="list__item" id="-44yyd9_295"><p id="-44yyd9_309"><span class="control" id="-44yyd9_310">Soyez Sp&eacute;cifique avec <code class="code" id="-44yyd9_313">@ExceptionHandler</code>:</span> Cr&eacute;ez des gestionnaires pour les exceptions sp&eacute;cifiques que vous pr&eacute;voyez et que vous pouvez traiter de mani&egrave;re particuli&egrave;re (ex: <code class="code" id="-44yyd9_311">ValidationException</code>, <code class="code" id="-44yyd9_312">ProductNotFoundException</code>).</p></li><li class="list__item" id="-44yyd9_296"><p id="-44yyd9_314"><span class="control" id="-44yyd9_315">Ayez un Gestionnaire Global :</span> Impl&eacute;mentez un <code class="code" id="-44yyd9_316">@ExceptionHandler(Exception.class)</code> ou utilisez un <code class="code" id="-44yyd9_317">ErrorController</code> personnalis&eacute; comme filet de s&eacute;curit&eacute; pour toutes les erreurs inattendues.</p></li><li class="list__item" id="-44yyd9_297"><p id="-44yyd9_318"><span class="control" id="-44yyd9_319">Utilisez les Statuts HTTP Corrects :</span> Mappez les exceptions aux statuts HTTP appropri&eacute;s (404 pour non trouv&eacute;, 400 pour mauvaise requ&ecirc;te, 403 pour interdit, 500 pour erreur serveur, etc.) en utilisant <code class="code" id="-44yyd9_320">@ResponseStatus</code> ou en les d&eacute;finissant dans votre <code class="code" id="-44yyd9_321">ErrorController</code>.</p></li><li class="list__item" id="-44yyd9_298"><p id="-44yyd9_322"><span class="control" id="-44yyd9_323">Diff&eacute;renciez les Erreurs Client (4xx) et Serveur (5xx) :</span> Les erreurs 4xx indiquent g&eacute;n&eacute;ralement un probl&egrave;me avec la requ&ecirc;te du client (donn&eacute;es invalides, ressource inexistante). Les erreurs 5xx indiquent un probl&egrave;me interne au serveur. Votre logging et la communication &agrave; l'utilisateur peuvent diff&eacute;rer. Loguez les 5xx comme des erreurs (<code class="code" id="-44yyd9_324">ERROR</code>), les 4xx peut-&ecirc;tre comme des avertissements (<code class="code" id="-44yyd9_325">WARN</code>) ou infos (<code class="code" id="-44yyd9_326">INFO</code>) selon le cas.</p></li><li class="list__item" id="-44yyd9_299"><p id="-44yyd9_327"><span class="control" id="-44yyd9_328">Centralisez avec <code class="code" id="-44yyd9_331">@ControllerAdvice</code>:</span> Pr&eacute;f&eacute;rez <code class="code" id="-44yyd9_329">@ControllerAdvice</code> pour la gestion globale plut&ocirc;t que de dupliquer des <code class="code" id="-44yyd9_330">@ExceptionHandler</code> dans chaque contr&ocirc;leur.</p></li><li class="list__item" id="-44yyd9_300"><p id="-44yyd9_332"><span class="control" id="-44yyd9_333">Pensez &agrave; l'Internationalisation (i18n) :</span> Vos messages d'erreur affich&eacute;s &agrave; l'utilisateur devraient &ecirc;tre internationalisables si votre application supporte plusieurs langues.</p></li></ol></section><section class="chapter"><h2 id="cas-d-utilisation-typiques" data-toc="cas-d-utilisation-typiques">Cas d'Utilisation Typiques</h2><ul class="list _bullet" id="-44yyd9_334"><li class="list__item" id="-44yyd9_336"><p id="-44yyd9_341"><span class="control" id="-44yyd9_342">Validation des Formulaires :</span> Une soumission de formulaire &eacute;choue &agrave; la validation (ex: champ email invalide). Une <code class="code" id="-44yyd9_343">BindException</code> ou <code class="code" id="-44yyd9_344">MethodArgumentNotValidException</code> est lev&eacute;e. Un <code class="code" id="-44yyd9_345">@ExceptionHandler</code> peut intercepter cette exception, renvoyer l'utilisateur au formulaire avec les messages d'erreur affich&eacute;s pr&egrave;s des champs concern&eacute;s (Statut HTTP souvent 200 OK car on r&eacute;-affiche une page valide, mais avec des erreurs).</p></li><li class="list__item" id="-44yyd9_337"><p id="-44yyd9_346"><span class="control" id="-44yyd9_347">Ressource Non Trouv&eacute;e :</span> Un utilisateur demande un produit avec un ID qui n'existe pas (<code class="code" id="-44yyd9_348">/products/999</code>). Le service l&egrave;ve une <code class="code" id="-44yyd9_349">ProductNotFoundException</code>. Un <code class="code" id="-44yyd9_350">@ExceptionHandler</code> intercepte, logue l'ID, et retourne une vue <code class="code" id="-44yyd9_351">error/product-not-found.html</code> avec un message convivial et un statut 404.</p></li><li class="list__item" id="-44yyd9_338"><p id="-44yyd9_352"><span class="control" id="-44yyd9_353">Acc&egrave;s Interdit :</span> Un utilisateur non administrateur tente d'acc&eacute;der &agrave; une page d'administration. Spring Security ( ou une logique manuelle) l&egrave;ve une <code class="code" id="-44yyd9_354">AccessDeniedException</code>. Un <code class="code" id="-44yyd9_355">@ExceptionHandler</code> ou la configuration de Spring Security redirige vers une page d'erreur 403 personnalis&eacute;e.</p></li><li class="list__item" id="-44yyd9_339"><p id="-44yyd9_356"><span class="control" id="-44yyd9_357">Erreur Interne Inattendue :</span> Une erreur de connexion &agrave; la base de donn&eacute;es survient. Une <code class="code" id="-44yyd9_358">DataAccessException</code> (ou une exception plus sp&eacute;cifique) est lev&eacute;e. Le gestionnaire <code class="code" id="-44yyd9_359">@ExceptionHandler(Exception.class)</code> ou le <code class="code" id="-44yyd9_360">CustomErrorController</code> intercepte, logue la trace de pile compl&egrave;te, et affiche une page d'erreur g&eacute;n&eacute;rique 500 demandant &agrave; l'utilisateur de r&eacute;essayer plus tard.</p></li><li class="list__item" id="-44yyd9_340"><p id="-44yyd9_361"><span class="control" id="-44yyd9_362">Conflit M&eacute;tier :</span> Tentative de suppression d'une cat&eacute;gorie contenant encore des produits. Le service l&egrave;ve une <code class="code" id="-44yyd9_363">CategoryNotEmptyException</code>. Un <code class="code" id="-44yyd9_364">@ExceptionHandler</code> intercepte, retourne un statut 409 (Conflict) et affiche une page expliquant pourquoi la suppression est impossible.</p></li></ul></section><section class="chapter"><h2 id="exercices-pratiques" data-toc="exercices-pratiques">Exercices Pratiques</h2><section class="chapter"><h3 id="exercice-1-g-rer-une-nouvelle-exception-m-tier" data-toc="exercice-1-g-rer-une-nouvelle-exception-m-tier">Exercice 1 : G&eacute;rer une Nouvelle Exception M&eacute;tier</h3><p id="-44yyd9_368"><span class="control" id="-44yyd9_371">&Eacute;nonc&eacute; :</span></p><ul class="list _bullet" id="-44yyd9_369"><li class="list__item" id="-44yyd9_372"><p id="-44yyd9_380">Cr&eacute;ez une nouvelle exception personnalis&eacute;e <code class="code" id="-44yyd9_381">OrderProcessingException</code> dans le package <code class="code" id="-44yyd9_382">fr.formation.spring. exception</code>. Elle prendra un <code class="code" id="-44yyd9_383">orderId</code> (type <code class="code" id="-44yyd9_384">String</code>) et un message dans son constructeur.</p></li><li class="list__item" id="-44yyd9_373"><p id="-44yyd9_385">Cr&eacute;ez un <code class="code" id="-44yyd9_386">OrderController</code> simple avec une m&eacute;thode GET <code class="code" id="-44yyd9_387">/orders/{orderId}</code>. Si <code class="code" id="-44yyd9_388">orderId</code> est &eacute;gal &agrave; &quot;INVALID&quot;, levez la <code class="code" id="-44yyd9_389">OrderProcessingException</code>. Sinon, affichez une vue de succ&egrave;s simple (<code class="code" id="-44yyd9_390">order-details.html</code>).</p></li><li class="list__item" id="-44yyd9_374"><p id="-44yyd9_391">Dans votre <code class="code" id="-44yyd9_392">GlobalExceptionHandler</code> (la classe <code class="code" id="-44yyd9_393">@ControllerAdvice</code>), ajoutez une m&eacute;thode <code class="code" id="-44yyd9_394">@ExceptionHandler</code> pour intercepter <code class="code" id="-44yyd9_395">OrderProcessingException</code>.</p></li><li class="list__item" id="-44yyd9_375"><p id="-44yyd9_396">Cette m&eacute;thode doit loguer l'erreur (niveau WARN) avec l'ID de commande.</p></li><li class="list__item" id="-44yyd9_376"><p id="-44yyd9_397">Elle doit retourner un <code class="code" id="-44yyd9_398">ModelAndView</code> pointant vers une nouvelle vue <code class="code" id="-44yyd9_399">error/order-error.html</code>.</p></li><li class="list__item" id="-44yyd9_377"><p id="-44yyd9_400">Passez l'ID de la commande et le message d'erreur de l'exception &agrave; la vue.</p></li><li class="list__item" id="-44yyd9_378"><p id="-44yyd9_401">Cr&eacute;ez la vue <code class="code" id="-44yyd9_402">error/order-error.html</code> (Thymeleaf) affichant ces informations et un lien vers l'accueil.</p></li><li class="list__item" id="-44yyd9_379"><p id="-44yyd9_403">Testez en acc&eacute;dant &agrave; <code class="code" id="-44yyd9_404">/orders/VALID123</code> (devrait r&eacute;ussir) et <code class="code" id="-44yyd9_405">/orders/INVALID</code> (devrait montrer la page d'erreur).</p></li></ul><section class="chapter"><div class="collapse"><div class="collapse__title"><h4 id="correction-exercice-1" data-toc="correction-exercice-1"><span class="control" id="-44yyd9_420">Correction Exercice 1</span></h4></div><div class="collapse__content"><p id="-44yyd9_407"><span class="control" id="-44yyd9_421"><code class="code" id="-44yyd9_422">OrderProcessingException.java</code>:</span></p><div class="code-block" data-lang="java">
    package fr.formation.spring.exception;

public class OrderProcessingException extends RuntimeException {
    private final String orderId;

    public OrderProcessingException(String orderId, String message) {
        super(message);
        this.orderId = orderId;
    }

    public String getOrderId() {
        return orderId;
    }
}

</div><p id="-44yyd9_410"><span class="control" id="-44yyd9_423"><code class="code" id="-44yyd9_424">OrderController.java</code>:</span></p><div class="code-block" data-lang="java">
    package fr.formation.spring.controller;

import fr.formation.spring.exception.OrderProcessingException;
import org.springframework.stereotype.Controller;
import org.springframework.ui.Model;
import org.springframework.web.bind.annotation.GetMapping;
import org.springframework.web.bind.annotation.PathVariable;
import org.springframework.web.bind.annotation.RequestMapping;

@Controller
@RequestMapping(&quot;/orders&quot;)
public class OrderController {

    @GetMapping(&quot;/{orderId}&quot;)
    public String getOrderById(@PathVariable String orderId, Model model) {
        if (&quot;INVALID&quot;.equalsIgnoreCase(orderId)) {
            throw new OrderProcessingException(
                    orderId,
                    &quot;Order processing failed due to invalid data.&quot;
            );
        }
        model.addAttribute(&quot;orderId&quot;, orderId);
        // Suppose l'existence de templates/order-details.html
        return &quot;order-details&quot;;
    }
}
</div><p id="-44yyd9_413"><span class="control" id="-44yyd9_425">Ajout dans <code class="code" id="-44yyd9_426">GlobalExceptionHandler.java</code>:</span></p><div class="code-block" data-lang="java">
    // ... (imports et logger existants) ...

import fr.formation.spring.exception.OrderProcessingException; // Ajouter cet import

@ControllerAdvice
public class GlobalExceptionHandler {

    // ... (logger et autres handlers existants) ...

    @ExceptionHandler(OrderProcessingException.class)
    public ModelAndView handleOrderProcessingException(
            HttpServletRequest request,
            OrderProcessingException ex) {

        log.warn(&quot;OrderProcessingException for order {}: {} - Request: {}&quot;,
                ex.getOrderId(), ex.getMessage(), request.getRequestURI());

        ModelAndView modelAndView = new ModelAndView();
        modelAndView.addObject(&quot;errorMessage&quot;, ex.getMessage());
        modelAndView.addObject(&quot;failedOrderId&quot;, ex.getOrderId());
        modelAndView.addObject(&quot;requestedUrl&quot;, request.getRequestURL());
        // Définit la vue d'erreur spécifique
        modelAndView.setViewName(&quot;error/order-error&quot;);

        return modelAndView;
    }

    // ... (handleProductNotFound et handleGenericException) ...
}
</div><p id="-44yyd9_416"><span class="control" id="-44yyd9_427"><code class="code" id="-44yyd9_428">src/main/resources/templates/error/order-error.html</code>:</span></p><div class="code-block" data-lang="markup">
    &lt;!DOCTYPE html&gt;
&lt;html xmlns:th=&quot;http://www.thymeleaf.org&quot;&gt;
&lt;head&gt;
    &lt;meta charset=&quot;UTF-8&quot;&gt;
    &lt;title&gt;Erreur Commande&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
&lt;h1&gt;Erreur lors du Traitement de la Commande&lt;/h1&gt;
&lt;p&gt;Commande ID: &lt;strong th:text=&quot;${failedOrderId}&quot;&gt;[inconnu]&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;Message: &lt;em th:text=&quot;${errorMessage}&quot;&gt;[erreur]&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;URL: &lt;span th:text=&quot;${requestedUrl}&quot;&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;a th:href=&quot;@{/}&quot;&gt;Retour à l'accueil&lt;/a&gt;&lt;/p&gt;
&lt;/body&gt;
&lt;/html&gt;
</div><ul class="list _bullet" id="-44yyd9_418"><li class="list__item" id="-44yyd9_429"><p id="-44yyd9_430"><span class="control" id="-44yyd9_431"><code class="code" id="-44yyd9_432">src/main/resources/templates/order-details.html</code> (pour le cas succ&egrave;s) :</span></p></li></ul><div class="code-block" data-lang="markup">
&lt;!DOCTYPE html&gt;
&lt;html xmlns:th=&quot;http://www.thymeleaf.org&quot;&gt;
&lt;head&gt;
    &lt;meta charset=&quot;UTF-8&quot;&gt;
    &lt;title&gt;Détails Commande&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
&lt;h1&gt;Détails de la Commande&lt;/h1&gt;
&lt;p&gt;Commande ID: &lt;strong th:text=&quot;${orderId}&quot;&gt;[inconnu]&lt;/strong&gt; traitée avec succès.&lt;/p&gt;
&lt;p&gt;&lt;a th:href=&quot;@{/}&quot;&gt;Retour à l'accueil&lt;/a&gt;&lt;/p&gt;
&lt;/body&gt;
&lt;/html&gt;
</div></div></div></section></section><section class="chapter"><h3 id="exercice-2-utiliser-responsestatus-et-une-page-statique" data-toc="exercice-2-utiliser-responsestatus-et-une-page-statique">Exercice 2 : Utiliser <code class="code" id="-44yyd9_437">@ResponseStatus</code> et une Page Statique</h3><p id="-44yyd9_434"><span class="control" id="-44yyd9_438">&Eacute;nonc&eacute; :</span></p><ul class="list _bullet" id="-44yyd9_435"><li class="list__item" id="-44yyd9_439"><p id="-44yyd9_444">Cr&eacute;ez une nouvelle exception <code class="code" id="-44yyd9_445">ResourceForbiddenException</code> dans <code class="code" id="-44yyd9_446">fr.formation.spring.exception</code>. Annotez cette classe avec <code class="code" id="-44yyd9_447">@ResponseStatus(HttpStatus.FORBIDDEN)</code>. Elle prendra juste un message dans son constructeur.</p></li><li class="list__item" id="-44yyd9_440"><p id="-44yyd9_448">Dans un contr&ocirc;leur (par exemple, <code class="code" id="-44yyd9_449">DemoController</code>), cr&eacute;ez une m&eacute;thode GET <code class="code" id="-44yyd9_450">/admin-only</code> qui l&egrave;ve syst&eacute;matiquement cette <code class="code" id="-44yyd9_451">ResourceForbiddenException</code>.</p></li><li class="list__item" id="-44yyd9_441"><p id="-44yyd9_452">Cr&eacute;ez une page d'erreur <span class="emphasis" id="-44yyd9_453">statique</span> pour le code 403. Placez un fichier <code class="code" id="-44yyd9_454">403.html</code> dans <code class="code" id="-44yyd9_455">src/main/resources/templates/error/</code> (ou <code class="code" id="-44yyd9_456">src/main/resources/static/error/</code> si vous n'utilisez pas Thymeleaf pour les erreurs statiques). Cette page doit simplement afficher un message indiquant que l'acc&egrave;s est interdit.</p></li><li class="list__item" id="-44yyd9_442"><p id="-44yyd9_457">Assurez-vous qu'il n'y a <span class="emphasis" id="-44yyd9_458">pas</span> de <code class="code" id="-44yyd9_459">@ExceptionHandler</code> sp&eacute;cifique pour <code class="code" id="-44yyd9_460">ResourceForbiddenException</code> dans votre <code class="code" id="-44yyd9_461">@ControllerAdvice</code> (pour laisser <code class="code" id="-44yyd9_462">@ResponseStatus</code> et la page statique agir).</p></li><li class="list__item" id="-44yyd9_443"><p id="-44yyd9_463">Testez en acc&eacute;dant &agrave; <code class="code" id="-44yyd9_464">/admin-only</code>. Vous devriez voir votre page <code class="code" id="-44yyd9_465">403.html</code> personnalis&eacute;e.</p></li></ul><section class="chapter"><div class="collapse"><div class="collapse__title"><h4 id="correction-exercice-2" data-toc="correction-exercice-2"><span class="control" id="-44yyd9_476">Correction Exercice 2</span></h4></div><div class="collapse__content"><p id="-44yyd9_468"><span class="control" id="-44yyd9_477"><code class="code" id="-44yyd9_478">ResourceForbiddenException.java</code>:</span></p><div class="code-block" data-lang="java">
    package fr.formation.spring.exception;

import org.springframework.http.HttpStatus;
import org.springframework.web.bind.annotation.ResponseStatus;

@ResponseStatus(value = HttpStatus.FORBIDDEN, reason = &quot;Access to this resource is forbidden&quot;)
public class ResourceForbiddenException extends RuntimeException {
    public ResourceForbiddenException(String message) {
        super(message);
    }
}
</div><p id="-44yyd9_471"><span class="control" id="-44yyd9_479">Ajout dans <code class="code" id="-44yyd9_480">DemoController.java</code> (ou un autre contr&ocirc;leur) :</span></p><div class="code-block" data-lang="java">
    package fr.formation.spring.controller;

import fr.formation.spring.exception.ResourceForbiddenException;
import org.springframework.stereotype.Controller;
import org.springframework.web.bind.annotation.GetMapping;

@Controller
public class DemoController {

    // ... (autres méthodes comme causeError, sayHello) ...

    @GetMapping(&quot;/admin-only&quot;)
    public String adminOnlyResource() {
        // Simule une ressource nécessitant des droits spécifiques
        throw new ResourceForbiddenException(
                &quot;You do not have permission to access this page.&quot;
        );
    }
}
</div><p id="-44yyd9_473"><span class="control" id="-44yyd9_481"><code class="code" id="-44yyd9_482">src/main/resources/templates/error/403.html</code>:</span></p><div class="code-block" data-lang="markup">
    &lt;!DOCTYPE html&gt;
&lt;html&gt;
&lt;head&gt;
    &lt;meta charset=&quot;UTF-8&quot;&gt;
    &lt;title&gt;Accès Interdit&lt;/title&gt;
    &lt;style&gt;body {
        font-family: sans-serif;
        padding: 20px;
    }&lt;/style&gt;
&lt;/head&gt;
&lt;body&gt;
&lt;h1&gt;Accès Interdit (Erreur 403)&lt;/h1&gt;
&lt;p&gt;
    Désolé, vous n'avez pas les permissions nécessaires
    pour accéder à cette page.
&lt;/p&gt;
&lt;p&gt;
    &lt;a href=&quot;/&quot;&gt;Retour à l'accueil&lt;/a&gt;
&lt;/p&gt;
&lt;/body&gt;
&lt;/html&gt;
</div><p id="-44yyd9_475"><span class="control" id="-44yyd9_483">V&eacute;rification :</span> Assurez-vous qu'aucun <code class="code" id="-44yyd9_484">@ExceptionHandler(ResourceForbiddenException.class)</code> n'existe dans <code class="code" id="-44yyd9_485">GlobalExceptionHandler</code>. Le <code class="code" id="-44yyd9_486">@ExceptionHandler(Exception.class)</code> g&eacute;n&eacute;rique ne devrait pas non plus interf&eacute;rer si la gestion par statut HTTP via <code class="code" id="-44yyd9_487">ErrorController</code> ou page statique est prioritaire pour les erreurs 4xx/5xx.</p></div></div></section></section><section class="chapter"><h3 id="exercice-3-personnaliser-errorcontroller-pour-les-erreurs-404" data-toc="exercice-3-personnaliser-errorcontroller-pour-les-erreurs-404">Exercice 3 : Personnaliser <code class="code" id="-44yyd9_492">ErrorController</code> pour les Erreurs 404</h3><p id="-44yyd9_489"><span class="control" id="-44yyd9_493">&Eacute;nonc&eacute; :</span></p><ul class="list _bullet" id="-44yyd9_490"><li class="list__item" id="-44yyd9_494"><p id="-44yyd9_502">Impl&eacute;mentez (ou modifiez) le <code class="code" id="-44yyd9_503">CustomErrorController</code> vu dans la section 6.</p></li><li class="list__item" id="-44yyd9_495"><p id="-44yyd9_504">Assurez-vous qu'il injecte <code class="code" id="-44yyd9_505">ErrorAttributes</code>.</p></li><li class="list__item" id="-44yyd9_496"><p id="-44yyd9_506">Dans la m&eacute;thode <code class="code" id="-44yyd9_507">handleError</code>, r&eacute;cup&eacute;rez les attributs d'erreur (<code class="code" id="-44yyd9_508">timestamp</code>, <code class="code" id="-44yyd9_509">status</code>, <code class="code" id="-44yyd9_510">error</code>, <code class="code" id="-44yyd9_511">path</code>, <code class="code" id="-44yyd9_512">message</code>).</p></li><li class="list__item" id="-44yyd9_497"><p id="-44yyd9_513">Si le <code class="code" id="-44yyd9_515">statusCode</code> est 404 :</p><ul class="list _bullet" id="-44yyd9_514"><li class="list__item" id="-44yyd9_516"><p id="-44yyd9_518">Ajoutez un attribut suppl&eacute;mentaire au mod&egrave;le : <code class="code" id="-44yyd9_519">customMessage404</code> avec la valeur &quot;La ressource demand&eacute;e via l'URL fournie est introuvable.&quot;.</p></li><li class="list__item" id="-44yyd9_517"><p id="-44yyd9_520">Retournez le nom de la vue <code class="code" id="-44yyd9_521">error/404-custom</code> (vous devrez cr&eacute;er ce fichier).</p></li></ul></li><li class="list__item" id="-44yyd9_498"><p id="-44yyd9_522">Pour tous les autres codes d'erreur, retournez la vue <code class="code" id="-44yyd9_523">error/generic-error</code> (utilisez celle de la section 6 ou cr&eacute;ez-en une simple).</p></li><li class="list__item" id="-44yyd9_499"><p id="-44yyd9_524">Cr&eacute;ez la vue <code class="code" id="-44yyd9_525">error/404-custom.html</code> qui affiche les informations d'erreur standards <span class="emphasis" id="-44yyd9_526">et</span> le message personnalis&eacute; <code class="code" id="-44yyd9_527">customMessage404</code>.</p></li><li class="list__item" id="-44yyd9_500"><p id="-44yyd9_528">Testez en acc&eacute;dant &agrave; une URL qui n'existe pas (ex: <code class="code" id="-44yyd9_529">/this-url-does-not-exist</code>). Vous devriez voir votre page <code class="code" id="-44yyd9_530">404-custom.html</code> avec toutes les informations.</p></li><li class="list__item" id="-44yyd9_501"><p id="-44yyd9_531">Testez en d&eacute;clenchant une erreur 500 (ex: via <code class="code" id="-44yyd9_532">/cause-error</code> du <code class="code" id="-44yyd9_533">DemoController</code>). Vous devriez voir la page <code class="code" id="-44yyd9_534">generic-error.html</code>.</p></li></ul><section class="chapter"><h4 id="correction-exercice-3" data-toc="correction-exercice-3"><span class="control" id="-44yyd9_545">Correction Exercice 3</span></h4><p id="-44yyd9_536"><span class="control" id="-44yyd9_546"><code class="code" id="-44yyd9_547">CustomErrorController.java</code> (potentiellement mis &agrave; jour) :</span></p><div class="code-block" data-lang="java">
    package fr.formation.spring.controller;

// ... (imports existants de la section 6) ...

@Controller
public class CustomErrorController implements ErrorController {

    private final ErrorAttributes errorAttributes;

    public CustomErrorController(ErrorAttributes errorAttributes) {
        this.errorAttributes = errorAttributes;
    }

    @RequestMapping(&quot;/error&quot;)
    public String handleError(HttpServletRequest request, Model model) {
        ServletWebRequest webRequest = new ServletWebRequest(request);
        // Obtenir les attributs, inclure le message par défaut
        Map&lt;String, Object&gt; errorDetails = this.errorAttributes.getErrorAttributes(
                webRequest, ErrorAttributeOptions.defaults().including(
                        ErrorAttributeOptions.Include.MESSAGE)
        );

        Object status = request.getAttribute(RequestDispatcher.ERROR_STATUS_CODE);
        int statusCode = HttpStatus.INTERNAL_SERVER_ERROR.value();
        if (status != null) {
            statusCode = Integer.parseInt(status.toString());
        }

        model.addAttribute(&quot;statusCode&quot;, statusCode);
        model.addAttribute(&quot;timestamp&quot;, errorDetails.get(&quot;timestamp&quot;));
        model.addAttribute(&quot;errorMessage&quot;, errorDetails.get(&quot;message&quot;));
        model.addAttribute(&quot;errorDetails&quot;, errorDetails.get(&quot;error&quot;));
        model.addAttribute(&quot;path&quot;, errorDetails.get(&quot;path&quot;));

        // Logique spécifique pour 404
        if (statusCode == HttpStatus.NOT_FOUND.value()) {
            model.addAttribute(
                    &quot;customMessage404&quot;,
                    &quot;La ressource demandée via l'URL fournie est introuvable.&quot;
            );
            return &quot;error/404-custom&quot;; // Vue spécifique pour 404
        }

        // Vue par défaut pour les autres erreurs
        return &quot;error/generic-error&quot;;
    }
}
</div><p id="-44yyd9_539"><span class="control" id="-44yyd9_548"><code class="code" id="-44yyd9_549">src/main/resources/templates/error/404-custom.html</code>:</span></p><div class="code-block" data-lang="markup">
    &lt;!DOCTYPE html&gt;
&lt;html xmlns:th=&quot;http://www.thymeleaf.org&quot;&gt;
&lt;head&gt;
    &lt;meta charset=&quot;UTF-8&quot;&gt;
    &lt;title&gt;Page Non Trouvée (404)&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
&lt;h1&gt;Erreur 404 - Page Non Trouvée&lt;/h1&gt;
&lt;p style=&quot;color: red; font-weight: bold;&quot; th:text=&quot;${customMessage404}&quot;&gt;
    Message spécifique 404.
&lt;/p&gt;
&lt;hr/&gt;
&lt;h2&gt;Détails Techniques :&lt;/h2&gt;
&lt;p&gt;Timestamp: &lt;span th:text=&quot;${timestamp}&quot;&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;Statut: &lt;span th:text=&quot;${statusCode}&quot;&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;Erreur: &lt;span th:text=&quot;${errorDetails}&quot;&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;Chemin: &lt;span th:text=&quot;${path}&quot;&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;Message Système: &lt;span th:text=&quot;${errorMessage}&quot;&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;a th:href=&quot;@{/}&quot;&gt;Retour à l'accueil&lt;/a&gt;&lt;/p&gt;
&lt;/body&gt;
&lt;/html&gt;
</div><p id="-44yyd9_542"><span class="control" id="-44yyd9_550"><code class="code" id="-44yyd9_551">src/main/resources/templates/error/generic-error.html</code> (s'assurer qu'elle existe, comme celle de la section 6) :</span></p><div class="code-block" data-lang="markup">
    &lt;!DOCTYPE html&gt;
&lt;html xmlns:th=&quot;http://www.thymeleaf.org&quot;&gt;
&lt;head&gt;
    &lt;meta charset=&quot;UTF-8&quot;&gt;
    &lt;title&gt;Erreur Inattendue&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
&lt;h1&gt;Une Erreur s'est Produite (&lt;span th:text=&quot;${statusCode}&quot;&gt;&lt;/span&gt;)&lt;/h1&gt;
&lt;p&gt;Timestamp: &lt;span th:text=&quot;${timestamp}&quot;&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;Chemin: &lt;span th:text=&quot;${path}&quot;&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;Erreur: &lt;span th:text=&quot;${errorDetails}&quot;&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;Message: &lt;span th:text=&quot;${errorMessage}&quot;&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;a th:href=&quot;@{/}&quot;&gt;Retour à l'accueil&lt;/a&gt;&lt;/p&gt;
&lt;/body&gt;
&lt;/html&gt;
</div></section></section></section><section class="chapter"><h2 id="conclusion" data-toc="conclusion">Conclusion</h2><p id="-44yyd9_552">La gestion des exceptions est une partie int&eacute;grante du d&eacute;veloppement d'applications web robustes et conviviales. Spring Boot offre une gamme d'outils flexibles, allant des simples pages d'erreur statiques &agrave; la gestion centralis&eacute;e et dynamique avec <code class="code" id="-44yyd9_555">@ControllerAdvice</code> et <code class="code" id="-44yyd9_556">@ExceptionHandler</code>, en passant par la personnalisation fine via <code class="code" id="-44yyd9_557">ErrorController</code>.</p><p id="-44yyd9_553">Le choix de la strat&eacute;gie d&eacute;pendra de la complexit&eacute; de l'application et du niveau de contr&ocirc;le souhait&eacute;. Une combinaison de ces approches est souvent la solution la plus efficace : utiliser des pages statiques ou un <code class="code" id="-44yyd9_558">ErrorController</code> pour les erreurs HTTP g&eacute;n&eacute;riques (404, 500), et des <code class="code" id="-44yyd9_559">@ExceptionHandler</code> dans un <code class="code" id="-44yyd9_560">@ControllerAdvice</code> pour les exceptions m&eacute;tier sp&eacute;cifiques qui n&eacute;cessitent une logique ou une pr&eacute;sentation particuli&egrave;re.</p><p id="-44yyd9_554">En appliquant les bonnes pratiques (logging, messages clairs, statuts HTTP corrects), les d&eacute;veloppeurs peuvent significativement am&eacute;liorer la qualit&eacute; et la maintenabilit&eacute; de leurs applications Spring Boot.</p></section><div class="last-modified">Last modified: 13 mai 2025</div><div data-feedback-placeholder="true"></div><div class="navigation-links _bottom"><a href="030-01-controlleradvice.html" class="navigation-links__prev">ControllerAdvice</a><a href="0100-00-un-projet-complet.html" class="navigation-links__next">Un projet Note de concert</a></div></article><div id="disqus_thread"></div></div></section></main></div><script src="https://resources.jetbrains.com/writerside/apidoc/6.22.0-b725/app.js"></script></body></html>